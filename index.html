<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="İSTUN Mechatronics Engineering Department - Research, Education, and Innovation in Intelligent Systems">
    <meta name="keywords" content="mechatronics, engineering, robotics, automation, İSTUN, research">
    <meta property="og:title" content="İSTUN Mechatronics Engineering">
    <meta property="og:description" content="Research, Education, and Innovation in Intelligent Systems">
    <meta property="og:type" content="website">
    <title>İSTUN Mechatronics Engineering</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect fill='%236366f1' rx='15' width='100' height='100'/><text x='50' y='65' font-size='50' text-anchor='middle' fill='white'>âš™</text></svg>">
    <link
        href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=Fraunces:ital,wght@0,400;0,500;0,600;1,400&family=JetBrains+Mono:wght@400;500&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <script>
        // ╔════════════════════════════════════════════════════════════════════════════╗
        // ║  GOOGLE SHEET CONFIGURATION - CHANGE THIS TO YOUR SHEET ID                 ║
        // ╚════════════════════════════════════════════════════════════════════════════╝

        const GOOGLE_SHEET_ID = '1MrgcCLRlEUTGaKUI62GcdmlIRqPPwfETx6AREZzpGKI';

        // Sheet tab names (must match exactly your Google Sheet tab names)
        const SHEETS = {
            settings: 'Settings',
            news: 'News',
            events: 'Events',
            faculty: 'Faculty',
            research: 'Research',
            publications: 'Publications',
            courses: 'Courses',
            projects: 'Projects',
            labs: 'Labs',
            jobs: 'Jobs',
            alumni: 'Alumni',
            partners: 'Partners',
            students: 'Students'
        };
    </script>

    <style>
        :root {
            --primary: #0c1220;
            --secondary: #1e293b;
            --accent: #6366f1;
            --accent-hover: #4f46e5;
            --accent-light: #eef2ff;
            --green: #10b981;
            --green-light: #ecfdf5;
            --amber: #f59e0b;
            --amber-light: #fffbeb;
            --pink: #ec4899;
            --pink-light: #fdf2f8;
            --purple: #8b5cf6;
            --purple-light: #f5f3ff;
            --red: #ef4444;
            --red-light: #fef2f2;
            --cyan: #06b6d4;
            --cyan-light: #ecfeff;
            --bg-cream: #faf8f5;
            --bg-warm: #f5f3ef;
            --border: #e5e2dc;
            --border-dark: #d1cdc4;
            --text-main: #1a1a1a;
            --text: #1a1a1a;
            --text-secondary: #374151;
            --text-muted: #64748b;
            --text-light: #94a3b8;
            --sidebar-width: 250px;
            --header-height: 60px;
            --font-display: 'Fraunces', Georgia, serif;
            --font-body: 'DM Sans', system-ui, sans-serif;
            --font-mono: 'JetBrains Mono', monospace;
            --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            --radius-sm: 6px;
            --radius-md: 10px;
            --radius-lg: 14px;
            --radius-xl: 20px;
        }

        *,
        *::before,
        *::after {
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-body);
            background: var(--bg-cream);
            color: var(--text-main);
            margin: 0;
            overflow: hidden;
            height: 100vh;
            display: flex;
            flex-direction: column;
            line-height: 1.6;
            font-size: 14px;
        }

        h1,
        h2,
        h3,
        h4 {
            font-family: var(--font-display);
            font-weight: 500;
            letter-spacing: -0.02em;
            line-height: 1.25;
        }

        h1 {
            font-size: clamp(1.5rem, 4vw, 2rem);
        }

        h2 {
            font-size: clamp(1.1rem, 3vw, 1.4rem);
            margin-bottom: 1rem;
        }

        h3 {
            font-size: 1rem;
        }

        h4 {
            font-size: 0.9rem;
        }

        a {
            color: var(--accent);
            text-decoration: none;
        }

        p {
            color: var(--text-secondary);
            margin: 0 0 1rem 0;
        }

        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-warm);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border-dark);
            border-radius: 3px;
        }

        /* HEADER */
        header {
            height: var(--header-height);
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 1rem;
            position: fixed;
            width: 100%;
            top: 0;
            background: rgba(250, 248, 245, 0.97);
            backdrop-filter: blur(12px);
            z-index: 100;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .logo {
            font-family: var(--font-display);
            font-weight: 600;
            font-size: 1rem;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
        }

        .logo-icon {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, var(--accent), var(--green));
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 0.85rem;
        }

        .mobile-menu-btn {
            display: none;
            background: none;
            border: 1px solid var(--border);
            padding: 0.4rem 0.6rem;
            border-radius: var(--radius-sm);
            cursor: pointer;
            font-size: 1rem;
        }

        .header-center {
            flex: 1;
            max-width: 320px;
            margin: 0 1.5rem;
        }

        .search-box {
            position: relative;
        }

        .search-box input {
            width: 100%;
            padding: 0.4rem 0.8rem 0.4rem 2rem;
            border-radius: 20px;
            border: 1px solid var(--border);
            background: var(--bg-warm);
            font-size: 0.8rem;
            font-family: var(--font-body);
        }

        .search-box input:focus {
            outline: none;
            border-color: var(--accent);
            background: white;
        }

        .search-box i {
            position: absolute;
            left: 10px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-muted);
            font-size: 0.75rem;
            pointer-events: none;
        }

        .search-results {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid var(--border);
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.15);
            max-height: 400px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
            margin-top: 8px;
        }

        .search-results.show {
            display: block;
        }

        .search-result-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            cursor: pointer;
            border-bottom: 1px solid var(--border);
            transition: background 0.15s;
        }

        .search-result-item:last-child {
            border-bottom: none;
        }

        .search-result-item:hover {
            background: var(--bg-warm);
        }

        .search-result-icon {
            width: 36px;
            height: 36px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            flex-shrink: 0;
        }

        .search-result-content {
            flex: 1;
            min-width: 0;
        }

        .search-result-title {
            font-weight: 600;
            font-size: 0.9rem;
            color: var(--text);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .search-result-meta {
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        .search-no-results {
            padding: 24px;
            text-align: center;
            color: var(--text-muted);
        }

        .search-category {
            padding: 8px 16px;
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-muted);
            background: var(--bg-warm);
            border-bottom: 1px solid var(--border);
        }

        .header-right {
            display: flex;
            gap: 0.4rem;
            align-items: center;
        }

        .lang-switcher {
            display: flex;
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            overflow: hidden;
        }

        .lang-btn {
            padding: 0.3rem 0.5rem;
            font-size: 0.7rem;
            font-weight: 600;
            border: none;
            background: transparent;
            cursor: pointer;
            color: var(--text-muted);
            font-family: var(--font-body);
        }

        .lang-btn.active {
            background: var(--primary);
            color: white;
        }

        .header-btn {
            width: 32px;
            height: 32px;
            border-radius: var(--radius-sm);
            border: 1px solid var(--border);
            background: transparent;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-muted);
            font-size: 0.8rem;
            position: relative;
        }

        .header-btn:hover {
            background: white;
        }

        .header-btn .badge {
            position: absolute;
            top: -3px;
            right: -3px;
            width: 14px;
            height: 14px;
            background: var(--red);
            color: white;
            font-size: 0.5rem;
            font-weight: 700;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .header-btn .badge:empty,
        .header-btn .badge[data-count="0"] {
            display: none;
        }

        /* LAYOUT */
        .layout-wrapper {
            display: flex;
            margin-top: var(--header-height);
            height: calc(100vh - var(--header-height));
        }

        /* SIDEBAR */
        aside {
            width: var(--sidebar-width);
            background: var(--bg-warm);
            border-right: 1px solid var(--border);
            overflow-y: auto;
            padding: 0.85rem 0.5rem;
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .nav-section-title {
            font-family: var(--font-mono);
            font-size: 0.55rem;
            text-transform: uppercase;
            color: var(--text-light);
            margin: 0 0 0.3rem 0.6rem;
            font-weight: 600;
            letter-spacing: 0.1em;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 0.45rem 0.65rem;
            border-radius: var(--radius-sm);
            color: var(--text-muted);
            font-size: 0.78rem;
            font-weight: 500;
            cursor: pointer;
            border: 1px solid transparent;
            margin-bottom: 1px;
            transition: all 0.15s;
        }

        .nav-item:hover {
            background: white;
            color: var(--text-main);
            border-color: var(--border);
        }

        .nav-item.active {
            background: white;
            color: var(--accent);
            border-color: var(--border);
            font-weight: 600;
        }

        .nav-item i {
            width: 14px;
            text-align: center;
            font-size: 0.75rem;
        }

        .nav-dot {
            width: 5px;
            height: 5px;
            border-radius: 50%;
        }

        .nav-badge {
            margin-left: auto;
            background: var(--accent);
            color: white;
            font-size: 0.55rem;
            padding: 1px 5px;
            border-radius: 8px;
            font-weight: 700;
        }

        .nav-badge.green {
            background: var(--green);
        }

        .nav-badge.amber {
            background: var(--amber);
        }

        .sidebar-card {
            margin-top: auto;
            padding: 0.75rem;
            background: white;
            border-radius: var(--radius-md);
            border: 1px solid var(--border);
            font-size: 0.72rem;
        }

        .sidebar-card-title {
            font-weight: 600;
            margin-bottom: 0.3rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .sidebar-card-title i {
            color: var(--amber);
        }

        .sidebar-card p {
            font-size: 0.68rem;
            color: var(--text-muted);
            margin: 0 0 0.5rem 0;
        }

        /* SIDEBAR DATA PANEL */
        .sidebar-data-panel {
            margin-top: auto;
            border-top: 1px solid var(--border);
            background: #faf8f5;
        }
        
        .sidebar-data-toggle {
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem 1rem;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 0.8rem;
            color: var(--text-secondary);
            transition: background 0.2s;
        }
        
        .sidebar-data-toggle:hover {
            background: var(--bg-warm);
        }
        
        .sidebar-data-toggle-left {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .sidebar-data-toggle-left i {
            color: var(--accent);
        }
        
        .sidebar-data-toggle-right {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .sidebar-data-toggle-right i {
            font-size: 0.65rem;
            transition: transform 0.3s;
        }
        
        .sidebar-data-panel.open .sidebar-data-toggle-right i {
            transform: rotate(180deg);
        }
        
        .data-status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #22c55e;
            transition: background 0.3s;
        }
        
        .data-status-dot.loading {
            background: #f59e0b;
            animation: pulse 1s infinite;
        }
        
        .data-status-dot.has-changes {
            background: #f59e0b;
            box-shadow: 0 0 0 3px rgba(245, 158, 11, 0.2);
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.4; }
        }
        
        .sidebar-data-content {
            display: none;
            padding: 0 1rem 1rem;
        }
        
        .sidebar-data-panel.open .sidebar-data-content {
            display: block;
        }
        
        .data-info-row {
            display: flex;
            justify-content: space-between;
            font-size: 0.75rem;
            margin-bottom: 0.75rem;
            padding-bottom: 0.75rem;
            border-bottom: 1px solid var(--border);
        }
        
        .data-info-label {
            color: var(--text-muted);
        }
        
        .data-info-value {
            color: var(--text-primary);
            font-weight: 500;
        }
        
        .data-actions-row {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 0.75rem;
        }
        
        .data-actions-row .btn {
            flex: 1;
            justify-content: center;
        }
        
        .data-changelog {
            background: #fff;
            border: 1px solid var(--border);
            border-radius: 8px;
            margin-bottom: 0.75rem;
            overflow: hidden;
        }
        
        .data-changelog-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem 0.75rem;
            background: #faf8f5;
            border-bottom: 1px solid var(--border);
            font-size: 0.7rem;
            color: var(--text-secondary);
        }
        
        .data-changelog-content {
            max-height: 200px;
            overflow-y: auto;
            padding: 0.5rem 0.75rem;
            font-size: 0.7rem;
        }
        
        .changelog-item {
            display: flex;
            align-items: flex-start;
            gap: 0.5rem;
            padding: 0.5rem 0;
            border-bottom: 1px solid #f0eeea;
        }
        
        .changelog-item:last-child {
            border-bottom: none;
        }
        
        .changelog-icon {
            width: 22px;
            height: 22px;
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.65rem;
            color: #fff;
            flex-shrink: 0;
            margin-top: 2px;
        }
        
        .changelog-info {
            flex: 1;
            min-width: 0;
        }
        
        .changelog-name {
            font-weight: 600;
            color: var(--text-main);
            font-size: 0.75rem;
            margin-bottom: 2px;
        }
        
        .changelog-detail {
            color: var(--text-muted);
            font-size: 0.68rem;
            line-height: 1.4;
        }
        
        .changelog-detail strong {
            color: var(--text-main);
            font-weight: 500;
        }
        
        .changelog-summary {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem;
            background: linear-gradient(135deg, #ecfdf5 0%, #f0fdf4 100%);
            border-radius: 6px;
            margin-bottom: 0.5rem;
            font-size: 0.7rem;
            color: #166534;
            font-weight: 500;
        }
        
        .changelog-summary.has-changes {
            background: linear-gradient(135deg, #fef3c7 0%, #fef9c3 100%);
            color: #92400e;
        }
        
        .data-admin-row {
            padding-top: 0.5rem;
            border-top: 1px solid var(--border);
        }
        
        .btn-xs {
            padding: 0.2rem 0.4rem;
            font-size: 0.65rem;
        }

        /* MAIN */
        main {
            flex: 1;
            overflow-y: auto;
            background: var(--bg-cream);
        }

        .page {
            display: none;
            padding: 1.25rem 1.5rem 2rem;
            max-width: 1100px;
            margin: 0 auto;
            animation: fadeIn 0.3s ease;
        }

        .page.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(5px);
            }

            to {
                opacity: 1;
            }
        }

        .page-header {
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border);
        }

        .page-header h1 {
            margin: 0 0 0.2rem 0;
        }

        .page-header .subtitle {
            color: var(--text-muted);
            margin: 0;
            font-size: 0.9rem;
        }

        /* BUTTONS */
        .btn {
            padding: 0.45rem 0.85rem;
            font-size: 0.78rem;
            border-radius: var(--radius-sm);
            font-weight: 500;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            border: none;
            font-family: var(--font-body);
            transition: all 0.2s;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--secondary);
        }

        .btn-accent {
            background: var(--accent);
            color: white;
        }

        .btn-ghost {
            color: var(--text-secondary);
            background: transparent;
            border: 1px solid var(--border);
        }

        .btn-ghost:hover {
            background: white;
        }

        .btn-sm {
            padding: 0.35rem 0.6rem;
            font-size: 0.72rem;
        }

        .btn-lg {
            padding: 0.55rem 1.1rem;
            font-size: 0.85rem;
        }

        /* HERO */
        .hero {
            background: var(--primary);
            color: white;
            border-radius: var(--radius-xl);
            padding: 2rem 1.75rem;
            margin-bottom: 1.5rem;
            position: relative;
            overflow: hidden;
        }

        .hero::before {
            content: '';
            position: absolute;
            inset: 0;
            background: radial-gradient(ellipse at 15% 85%, rgba(99, 102, 241, 0.35), transparent 45%),
                radial-gradient(ellipse at 85% 15%, rgba(16, 185, 129, 0.25), transparent 45%);
        }

        .hero-content {
            position: relative;
            z-index: 1;
            max-width: 580px;
        }

        .hero h1 {
            color: white;
            margin: 0 0 0.5rem 0;
            font-weight: 400;
            font-style: italic;
            font-size: clamp(1.3rem, 4vw, 1.8rem);
        }

        .hero p {
            color: rgba(255, 255, 255, 0.85);
            margin: 0 0 1.25rem 0;
            font-size: 0.88rem;
        }

        .hero-actions {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .hero .btn-primary {
            background: white;
            color: var(--primary);
        }

        .hero .btn-ghost {
            border-color: rgba(255, 255, 255, 0.35);
            color: white;
        }

        /* STATS */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(110px, 1fr));
            gap: 0.6rem;
            margin-bottom: 1.5rem;
        }

        .stat-card {
            background: white;
            padding: 0.85rem;
            border-radius: var(--radius-md);
            text-align: center;
            border: 1px solid var(--border);
            transition: all 0.2s;
        }

        .stat-card:hover {
            border-color: var(--accent);
            transform: translateY(-2px);
        }

        .stat-value {
            font-family: var(--font-display);
            font-size: 1.35rem;
            font-weight: 600;
            color: var(--accent);
            display: block;
            line-height: 1;
        }

        .stat-label {
            font-size: 0.62rem;
            color: var(--text-muted);
            text-transform: uppercase;
            margin-top: 0.25rem;
        }

        /* CARDS */
        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(270px, 1fr));
            gap: 1rem;
        }

        .card-grid-sm {
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
        }

        .card {
            background: white;
            border-radius: var(--radius-lg);
            overflow: hidden;
            border: 1px solid var(--border);
            transition: all 0.2s;
        }

        .card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
            border-color: var(--accent);
        }

        .card-clickable {
            cursor: pointer;
        }

        .card-img {
            height: 130px;
            background-size: cover;
            background-position: center;
            position: relative;
        }

        .card-img-overlay {
            position: absolute;
            inset: 0;
            background: linear-gradient(to top, rgba(0, 0, 0, 0.5), transparent 60%);
        }

        .card-img-badge {
            position: absolute;
            top: 8px;
            left: 8px;
        }

        .card-body {
            padding: 0.9rem;
        }

        .card-body h3 {
            margin: 0 0 0.3rem 0;
            font-size: 0.92rem;
        }

        .card-body h4 {
            margin: 0 0 0.2rem 0;
            font-size: 0.85rem;
        }

        .card-body p {
            color: var(--text-muted);
            margin: 0;
            font-size: 0.78rem;
            line-height: 1.4;
        }

        .card-footer {
            padding: 0.7rem 0.9rem;
            border-top: 1px solid var(--border);
            font-size: 0.72rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: var(--text-muted);
        }

        .card-footer-link {
            color: var(--accent);
            font-weight: 600;
        }

        /* COMPACT CARD */
        .card-compact {
            display: flex;
            align-items: center;
            padding: 0.8rem;
            gap: 0.75rem;
            background: white;
            border: 1px solid var(--border);
            border-radius: var(--radius-md);
            transition: all 0.2s;
            margin-bottom: 0.5rem;
        }

        .card-compact:hover {
            border-color: var(--accent);
        }

        .card-compact-icon {
            width: 38px;
            height: 38px;
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.95rem;
            flex-shrink: 0;
        }

        .card-compact-content {
            flex: 1;
            min-width: 0;
        }

        .card-compact-content h4 {
            margin: 0 0 0.1rem 0;
            font-size: 0.82rem;
        }

        .card-compact-content p {
            margin: 0;
            font-size: 0.72rem;
            color: var(--text-muted);
        }

        /* TAGS */
        .tag {
            display: inline-flex;
            padding: 2px 7px;
            background: var(--bg-warm);
            color: var(--text-muted);
            border-radius: 20px;
            font-size: 0.62rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .tag-accent {
            background: var(--accent-light);
            color: var(--accent);
        }

        .tag-green {
            background: var(--green-light);
            color: var(--green);
        }

        .tag-amber {
            background: var(--amber-light);
            color: var(--amber);
        }

        .tag-pink {
            background: var(--pink-light);
            color: var(--pink);
        }

        .tag-purple {
            background: var(--purple-light);
            color: var(--purple);
        }

        .tag-red {
            background: var(--red-light);
            color: var(--red);
        }

        .tag-cyan {
            background: var(--cyan-light);
            color: var(--cyan);
        }

        /* SECTION */
        .section {
            margin-bottom: 2rem;
        }

        .section-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1rem;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .section-header h2 {
            margin: 0;
        }

        /* QUICK LINKS */
        .quick-links {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 0.5rem;
            margin-bottom: 1.5rem;
        }

        .quick-link {
            background: white;
            border: 1px solid var(--border);
            border-radius: var(--radius-md);
            padding: 0.75rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
        }

        .quick-link:hover {
            border-color: var(--accent);
            transform: translateY(-2px);
        }

        .quick-link i {
            font-size: 1rem;
            color: var(--accent);
            margin-bottom: 0.25rem;
            display: block;
        }

        .quick-link span {
            font-size: 0.72rem;
            font-weight: 500;
        }

        /* FACULTY */
        .faculty-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(170px, 1fr));
            gap: 0.75rem;
        }

        .faculty-card {
            background: white;
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            padding: 1rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            flex-direction: column;
            min-height: 220px;
        }

        .faculty-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
            border-color: var(--accent);
        }

        .faculty-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            margin: 0 auto 0.5rem;
            object-fit: cover;
            border: 3px solid var(--bg-warm);
        }

        .faculty-name {
            font-family: var(--font-display);
            font-size: 0.85rem;
            margin: 0 0 0.1rem 0;
        }

        .faculty-title {
            color: var(--text-muted);
            font-size: 0.68rem;
            margin: 0 0 0.35rem 0;
        }

        .faculty-field {
            font-size: 0.65rem;
            color: var(--accent);
            font-weight: 500;
        }
        
        .faculty-links-spacer {
            flex-grow: 1;
        }

        .faculty-links {
            display: flex;
            justify-content: center;
            gap: 0.25rem;
            margin-top: 0.5rem;
        }

        .faculty-links a {
            width: 22px;
            height: 22px;
            border-radius: 50%;
            background: var(--bg-warm);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-muted);
            font-size: 0.6rem;
            transition: all 0.2s;
        }

        .faculty-links a:hover {
            background: var(--accent);
            color: white;
        }

        /* PROJECT CARDS */
        .project-card {
            background: white;
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            overflow: hidden;
            transition: all 0.2s;
            cursor: pointer;
        }

        .project-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
            border-color: var(--purple);
        }

        .project-img {
            height: 120px;
            background-size: cover;
            background-position: center;
            position: relative;
        }

        .project-year {
            position: absolute;
            top: 8px;
            left: 8px;
            background: var(--purple);
            color: white;
            padding: 2px 8px;
            border-radius: var(--radius-sm);
            font-size: 0.62rem;
            font-weight: 700;
        }

        .project-body {
            padding: 0.85rem;
        }

        .project-body h4 {
            margin: 0 0 0.25rem 0;
            font-size: 0.85rem;
        }

        .project-body p {
            margin: 0 0 0.6rem 0;
            color: var(--text-muted);
            font-size: 0.72rem;
        }

        .project-team {
            display: flex;
            align-items: center;
            gap: 0.4rem;
        }

        .project-avatars {
            display: flex;
        }

        .project-avatars img {
            width: 22px;
            height: 22px;
            border-radius: 50%;
            border: 2px solid white;
            margin-left: -5px;
        }

        .project-avatars img:first-child {
            margin-left: 0;
        }

        .project-names {
            font-size: 0.68rem;
            color: var(--text-muted);
        }

        /* NEWS */
        .news-card {
            background: white;
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            overflow: hidden;
            transition: all 0.2s;
        }

        .news-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
            border-color: var(--amber);
        }

        .news-img {
            height: 130px;
            background-size: cover;
            background-position: center;
            position: relative;
        }

        .news-date {
            position: absolute;
            top: 8px;
            left: 8px;
            background: var(--amber);
            color: white;
            padding: 0.35rem 0.5rem;
            border-radius: var(--radius-sm);
            text-align: center;
            font-weight: 700;
            line-height: 1.1;
        }

        .news-date .day {
            font-size: 1rem;
            display: block;
        }

        .news-date .month {
            font-size: 0.55rem;
            text-transform: uppercase;
        }

        .news-body {
            padding: 0.85rem;
        }

        .news-body h4 {
            margin: 0 0 0.25rem 0;
            font-size: 0.85rem;
        }

        .news-body p {
            margin: 0;
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        /* PUBLICATIONS */
        .pub-item {
            padding: 0.85rem;
            background: white;
            border: 1px solid var(--border);
            border-radius: var(--radius-md);
            margin-bottom: 0.6rem;
            transition: all 0.2s;
        }

        .pub-item:hover {
            border-color: var(--accent);
        }

        .pub-title {
            font-weight: 600;
            margin-bottom: 0.25rem;
            line-height: 1.35;
            font-size: 0.85rem;
        }

        .pub-authors {
            font-size: 0.75rem;
            color: var(--text-muted);
            margin-bottom: 0.3rem;
        }

        .pub-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
            font-size: 0.7rem;
            color: var(--text-muted);
        }

        .pub-meta span {
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        /* RESEARCH */
        .research-card {
            background: white;
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            padding: 1rem;
            margin-bottom: 0.85rem;
            transition: all 0.2s;
        }

        .research-card:hover {
            border-color: var(--accent);
        }

        .research-header {
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            margin-bottom: 0.6rem;
        }

        .research-icon {
            width: 38px;
            height: 38px;
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.95rem;
            color: white;
            flex-shrink: 0;
        }

        .research-info h3 {
            margin: 0 0 0.1rem 0;
            font-size: 0.92rem;
        }

        .research-info p {
            margin: 0;
            font-size: 0.78rem;
            color: var(--text-muted);
        }

        .research-desc {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-bottom: 0.75rem;
            line-height: 1.45;
        }

        .research-members {
            display: flex;
            flex-wrap: wrap;
            gap: 0.3rem;
        }

        .research-member {
            display: flex;
            align-items: center;
            gap: 0.3rem;
            padding: 0.25rem 0.5rem;
            background: var(--bg-warm);
            border-radius: 20px;
            font-size: 0.68rem;
        }

        .research-member img {
            width: 16px;
            height: 16px;
            border-radius: 50%;
        }

        /* TIMELINE */
        .timeline {
            position: relative;
            padding-left: 1.4rem;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 4px;
            top: 3px;
            bottom: 12px;
            width: 2px;
            background: var(--border);
        }

        .timeline-item {
            position: relative;
            padding-bottom: 0.9rem;
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: -1.4rem;
            top: 3px;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--accent);
            border: 2px solid white;
            box-shadow: 0 0 0 2px var(--accent-light);
        }

        .timeline-date {
            font-size: 0.65rem;
            color: var(--text-muted);
            font-weight: 600;
            text-transform: uppercase;
        }

        .timeline-card {
            background: white;
            border: 1px solid var(--border);
            border-radius: var(--radius-md);
            padding: 0.7rem;
            margin-top: 0.3rem;
        }

        .timeline-card h4 {
            margin: 0.2rem 0;
            font-size: 0.82rem;
        }

        .timeline-card p {
            margin: 0;
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        /* TABS */
        .tabs {
            display: flex;
            gap: 0.25rem;
            margin-bottom: 1rem;
            border-bottom: 1px solid var(--border);
            padding-bottom: 0.6rem;
            flex-wrap: wrap;
        }

        .tab {
            padding: 0.38rem 0.7rem;
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            background: transparent;
            font-size: 0.75rem;
            font-weight: 500;
            cursor: pointer;
            font-family: var(--font-body);
            color: var(--text-muted);
        }

        .tab.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .tab:hover:not(.active) {
            background: var(--bg-warm);
        }

        /* TABLE */
        .table-wrapper {
            overflow-x: auto;
            border: 1px solid var(--border);
            border-radius: var(--radius-md);
            background: white;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
        }

        .data-table th,
        .data-table td {
            padding: 0.65rem 0.8rem;
            text-align: left;
            border-bottom: 1px solid var(--border);
            font-size: 0.78rem;
        }

        .data-table th {
            background: var(--bg-warm);
            font-size: 0.62rem;
            text-transform: uppercase;
            font-weight: 600;
            color: var(--text-muted);
        }

        .data-table tr:last-child td {
            border-bottom: none;
        }

        .data-table tr:hover td {
            background: var(--bg-cream);
        }

        /* STATUS */
        .status {
            padding: 2px 6px;
            border-radius: 20px;
            font-size: 0.62rem;
            font-weight: 600;
        }

        .status-active {
            background: var(--green-light);
            color: var(--green);
        }

        .status-pending {
            background: var(--amber-light);
            color: var(--amber);
        }

        /* COURSE */
        .course-item {
            background: white;
            border: 1px solid var(--border);
            border-radius: var(--radius-md);
            padding: 0.7rem 0.8rem;
            display: flex;
            align-items: center;
            gap: 0.7rem;
            margin-bottom: 0.5rem;
            transition: all 0.2s;
        }

        .course-item:hover {
            border-color: var(--accent);
        }

        .course-icon {
            width: 36px;
            height: 36px;
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.88rem;
            flex-shrink: 0;
        }

        .course-info {
            flex: 1;
        }

        .course-info h4 {
            margin: 0 0 0.1rem 0;
            font-size: 0.82rem;
        }

        .course-info p {
            margin: 0;
            color: var(--text-muted);
            font-size: 0.7rem;
        }

        /* PARTNERS */
        .partners-row {
            display: flex;
            flex-wrap: wrap;
            gap: 2rem;
            justify-content: center;
            align-items: center;
            padding: 1.25rem;
            background: white;
            border-radius: var(--radius-lg);
            border: 1px solid var(--border);
        }

        .partner-logo {
            height: 24px;
            opacity: 0.5;
            filter: grayscale(100%);
            transition: all 0.2s;
        }

        .partner-logo:hover {
            opacity: 1;
            filter: grayscale(0%);
        }

        /* ALERTS */
        .alert {
            padding: 0.7rem 0.8rem;
            border-radius: var(--radius-md);
            margin-bottom: 0.8rem;
            display: flex;
            align-items: flex-start;
            gap: 0.6rem;
            font-size: 0.8rem;
        }

        .alert i {
            font-size: 0.85rem;
            margin-top: 0.05rem;
        }

        .alert-info {
            background: var(--accent-light);
            color: var(--accent);
            border: 1px solid rgba(99, 102, 241, 0.2);
        }

        .alert-success {
            background: var(--green-light);
            color: #047857;
            border: 1px solid rgba(16, 185, 129, 0.2);
        }

        .alert-warning {
            background: var(--amber-light);
            color: #b45309;
            border: 1px solid rgba(245, 158, 11, 0.2);
        }

        /* LOADING */
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
            color: var(--text-muted);
        }

        .loading i {
            margin-right: 0.5rem;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            from {
                transform: rotate(0deg);
            }

            to {
                transform: rotate(360deg);
            }
        }

        .skeleton {
            background: linear-gradient(90deg, var(--bg-warm) 25%, var(--border) 50%, var(--bg-warm) 75%);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
            border-radius: var(--radius-sm);
        }

        @keyframes shimmer {
            0% {
                background-position: 200% 0;
            }

            100% {
                background-position: -200% 0;
            }
        }

        /* TWO COLS */
        .two-cols {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.25rem;
        }

        /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
           DETAIL PAGE STYLES
           â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .detail-page {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 1rem;
        }
        
        .detail-back {
            margin-bottom: 1rem;
        }
        
        .detail-card {
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            overflow: hidden;
        }
        
        .detail-image {
            width: 100%;
            height: 280px;
            background-size: cover;
            background-position: center;
            background-color: #f0eeea;
        }
        
        .detail-body {
            padding: 1.5rem;
        }
        
        .detail-meta {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.75rem;
        }
        
        .detail-date, .detail-author {
            font-size: 0.85rem;
            color: #64748b;
        }
        
        .detail-date i, .detail-author i {
            margin-right: 0.3rem;
        }
        
        .detail-title {
            font-size: 1.75rem;
            font-weight: 700;
            color: #0c1220;
            margin: 0 0 1.25rem 0;
            line-height: 1.3;
        }
        
        .detail-info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
            padding: 1rem;
            background: #faf8f5;
            border-radius: 12px;
        }
        
        .detail-info-item {
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
        }
        
        .detail-info-item > i {
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #fff;
            border-radius: 8px;
            color: #6366f1;
            font-size: 0.9rem;
            flex-shrink: 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
        }
        
        .detail-info-label {
            display: block;
            font-size: 0.75rem;
            color: #64748b;
            text-transform: uppercase;
            letter-spacing: 0.03em;
            margin-bottom: 0.15rem;
        }
        
        .detail-info-value {
            display: block;
            font-size: 0.95rem;
            font-weight: 500;
            color: #0c1220;
        }
        
        .detail-speaker-box {
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            padding: 1rem;
            background: linear-gradient(135deg, #ede9fe 0%, #e0e7ff 100%);
            border-radius: 12px;
            margin-bottom: 1.5rem;
        }
        
        .detail-speaker-box > i {
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #fff;
            border-radius: 8px;
            color: #6366f1;
            font-size: 0.9rem;
            flex-shrink: 0;
        }
        
        .detail-content {
            line-height: 1.8;
            font-size: 1rem;
            color: #334155;
            white-space: pre-line;
        }
        
        .detail-tech-box, .detail-equipment-box {
            margin-top: 1.5rem;
            padding: 1rem;
            background: #faf8f5;
            border-radius: 12px;
        }
        
        .detail-tech-box h4, .detail-equipment-box h4 {
            margin: 0 0 0.75rem 0;
            font-size: 0.9rem;
            color: #0c1220;
        }
        
        .detail-tech-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.4rem;
        }
        
        .detail-equipment-box {
            background: linear-gradient(135deg, #dcfce7 0%, #d1fae5 100%);
            border-left: 4px solid #22c55e;
        }
        
        .detail-equipment-box h4 {
            color: #16a34a;
        }
        
        .detail-equipment-box p {
            margin: 0;
            color: #334155;
            line-height: 1.6;
        }
        
        .detail-actions {
            margin-top: 1.5rem;
            padding-top: 1.5rem;
            border-top: 1px solid #e2e0dc;
        }

        /* RESPONSIVE */
        @media (max-width: 1024px) {
            .two-cols {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            aside {
                position: fixed;
                left: -100%;
                top: var(--header-height);
                height: calc(100vh - var(--header-height));
                z-index: 90;
                width: 260px;
                transition: left 0.3s ease;
            }

            aside.open {
                left: 0;
            }

            .sidebar-overlay {
                display: none;
                position: fixed;
                inset: 0;
                background: rgba(0, 0, 0, 0.4);
                z-index: 85;
                top: var(--header-height);
            }

            .sidebar-overlay.show {
                display: block;
            }

            .mobile-menu-btn {
                display: block;
            }

            .header-center {
                display: none;
            }

            .page {
                padding: 1rem;
            }

            /* Detail page mobile */
            .detail-page {
                padding: 0;
            }
            
            .detail-title {
                font-size: 1.4rem;
            }
            
            .detail-image {
                height: 200px;
            }
            
            .detail-info-grid {
                grid-template-columns: 1fr;
                gap: 0.75rem;
            }
            
            .detail-body {
                padding: 1rem;
            }

            .hero {
                padding: 1.5rem 1.25rem;
            }

            .hero-actions {
                flex-direction: column;
            }

            .card-grid {
                grid-template-columns: 1fr;
            }

            .faculty-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* LANGUAGE */
        [data-en],
        [data-tr] {
            display: none;
        }

        html[lang="en"] [data-en] {
            display: inline;
        }

        html[lang="en"] [data-en].block {
            display: block;
        }

        html[lang="en"] [data-en].flex {
            display: flex;
        }

        html[lang="en"] [data-en].grid {
            display: grid;
        }

        html[lang="tr"] [data-tr] {
            display: inline;
        }

        html[lang="tr"] [data-tr].block {
            display: block;
        }

        html[lang="tr"] [data-tr].flex {
            display: flex;
        }

        html[lang="tr"] [data-tr].grid {
            display: grid;
        }

        /* ACADEMIC PROFILE PAGE */
        .profile-layout {
            display: grid;
            grid-template-columns: 280px 1fr;
            gap: 2.5rem;
            margin-top: 1.5rem;
        }

        .profile-sidebar {
            position: sticky;
            top: 2rem;
            height: fit-content;
        }

        .profile-photo-container {
            width: 100%;
            aspect-ratio: 1;
            border-radius: var(--radius-lg);
            overflow: hidden;
            border: 1px solid var(--border);
            margin-bottom: 1.5rem;
            background: var(--bg-warm);
        }

        .profile-photo-container img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .profile-contact-list {
            list-style: none;
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .profile-contact-link {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.6rem 0.8rem;
            background: var(--bg-warm);
            border: 1px solid var(--border);
            border-radius: var(--radius-md);
            color: var(--text-main);
            text-decoration: none;
            font-size: 0.9rem;
            transition: all 0.2s;
        }

        .profile-contact-link:hover {
            border-color: var(--accent);
            background: white;
            color: var(--accent);
            transform: translateY(-1px);
        }

        .profile-main h2 {
            font-size: 1.4rem;
            margin: 2rem 0 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--accent-light);
        }

        .profile-main h2:first-of-type {
            margin-top: 0;
        }

        .profile-bio {
            line-height: 1.7;
            color: var(--text-muted);
            margin-bottom: 2rem;
        }

        .profile-meta-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
        }

        .meta-item label {
            display: block;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--accent);
            font-weight: 700;
            margin-bottom: 0.4rem;
        }

        .meta-item p {
            font-weight: 500;
            color: var(--text-main);
        }

        @media (max-width: 900px) {
            .profile-layout {
                grid-template-columns: 1fr;
            }

            .profile-sidebar {
                position: static;
                max-width: 300px;
                margin: 0 auto;
            }
        }
        
        /* Profile Related Content */
        .profile-related-list {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }
        
        .profile-related-item {
            padding: 0.75rem 1rem;
            background: var(--bg-warm);
            border-radius: var(--radius);
            border-left: 3px solid var(--accent);
        }
        
        .profile-related-item h4 {
            font-size: 0.9rem;
            margin: 0 0 0.25rem 0;
            color: var(--text-main);
        }
        
        .profile-related-item p {
            font-size: 0.8rem;
            color: var(--text-muted);
            margin: 0;
        }
        
        .profile-related-item .tag {
            font-size: 0.65rem;
            margin-right: 0.5rem;
        }

        .card-clickable {
            cursor: pointer;
            transition: transform 0.2s, border-color 0.2s, box-shadow 0.2s;
        }

        .card-clickable:hover {
            transform: translateY(-4px);
            border-color: var(--accent);
            box-shadow: var(--shadow-lg);
        }
    </style>
</head>

<body>

    <header>
        <div class="header-left">
            <button class="mobile-menu-btn" onclick="toggleSidebar()"><i class="fa-solid fa-bars"></i></button>
            <a class="logo" onclick="goTo('home')">
                <div class="logo-icon"><i class="fa-solid fa-microchip"></i></div>
                <span id="siteName">İSTUN Mechatronics Engineering</span>
            </a>
        </div>
        <div class="header-center">
            <div class="search-box">
                <i class="fa-solid fa-magnifying-glass"></i>
                <input type="text" id="searchInput" placeholder="Search..." oninput="performSearch(this.value)" onfocus="showSearchResults()" onblur="hideSearchResultsDelayed()">
                <div class="search-results" id="searchResults"></div>
            </div>
        </div>
        <div class="header-right">
            <div class="lang-switcher">
                <button class="lang-btn active" onclick="setLang('en')">EN</button>
                <button class="lang-btn" onclick="setLang('tr')">TR</button>
            </div>
            <button class="header-btn"><i class="fa-solid fa-bell"></i><span class="badge"
                    id="notifBadge" data-count="0">0</span></button>
        </div>
    </header>

    <div class="sidebar-overlay" onclick="toggleSidebar()"></div>

    <div class="layout-wrapper">
        <aside id="sidebar">
            <div class="nav-section">
                <div class="nav-section-title">Overview</div>
                <a class="nav-item active" data-page="home" onclick="goTo('home', this)"><i
                        class="fa-solid fa-house"></i> <span data-en>Home</span><span data-tr>Ana Sayfa</span></a>
                <a class="nav-item" data-page="about" onclick="goTo('about', this)"><i class="fa-solid fa-landmark"></i>
                    <span data-en>About</span><span data-tr>Hakkında</span></a>
                <a class="nav-item" data-page="news" onclick="goTo('news', this)">
                    <div class="nav-dot" style="background:var(--amber);"></div> <span data-en>News</span><span
                        data-tr>Haberler</span> <span class="nav-badge amber" id="newsBadge">0</span>
                </a>
            </div>
            <div class="nav-section">
                <div class="nav-section-title">Research</div>
                <a class="nav-item" data-page="research" onclick="goTo('research', this)"><i
                        class="fa-solid fa-flask"></i> <span data-en>Research</span><span data-tr>Araştırma</span></a>
                <a class="nav-item" data-page="publications" onclick="goTo('publications', this)"><i
                        class="fa-solid fa-book"></i> <span data-en>Publications</span><span data-tr>Yayınlar</span></a>
                <a class="nav-item" data-page="labs" onclick="goTo('labs', this)">
                    <div class="nav-dot" style="background:var(--green);"></div> <span data-en>Labs</span><span
                        data-tr>Lablar</span>
                </a>
            </div>
            <div class="nav-section">
                <div class="nav-section-title">People</div>
                <a class="nav-item" data-page="faculty" onclick="goTo('faculty', this)"><i
                        class="fa-solid fa-users"></i> <span data-en>Faculty</span><span
                        data-tr>Akademisyenler</span></a>
                <a class="nav-item" data-page="students" onclick="goTo('students', this)"><i
                        class="fa-solid fa-user-graduate"></i> <span data-en>Students</span><span
                        data-tr>Öğrenciler</span></a>
                <a class="nav-item" data-page="alumni" onclick="goTo('alumni', this)"><i class="fa-solid fa-medal"></i>
                    <span data-en>Alumni</span><span data-tr>Mezunlar</span></a>
            </div>
            <div class="nav-section">
                <div class="nav-section-title">Academics</div>
                <a class="nav-item" data-page="projects" onclick="goTo('projects', this)">
                    <div class="nav-dot" style="background:var(--purple);"></div> <span data-en>Projects</span><span
                        data-tr>Projeler</span>
                </a>
                <a class="nav-item" data-page="courses" onclick="goTo('courses', this)"><i
                        class="fa-solid fa-book-open"></i> <span data-en>Courses</span><span data-tr>Dersler</span></a>
            </div>
            <div class="nav-section">
                <div class="nav-section-title">Resources</div>
                <a class="nav-item" data-page="jobs" onclick="goTo('jobs', this)"><i class="fa-solid fa-briefcase"></i>
                    <span data-en>Jobs</span><span data-tr>İş İlanları</span> <span class="nav-badge green"
                        id="jobsBadge">0</span></a>
                <a class="nav-item" data-page="partners" onclick="goTo('partners', this)"><i
                        class="fa-solid fa-handshake"></i> <span data-en>Partners</span><span
                        data-tr>Ortaklar</span></a>
                <a class="nav-item" data-page="contact" onclick="goTo('contact', this)"><i
                        class="fa-solid fa-envelope"></i> <span data-en>Contact</span><span data-tr>İletişim</span></a>
            </div>
            <div class="sidebar-card" id="nextEventCard">
                <div class="sidebar-card-title"><i class="fa-solid fa-calendar-day"></i> <span data-en>Next
                        Event</span><span data-tr>Etkinlik</span></div>
                <p id="nextEventText">Loading...</p>
                <button class="btn btn-sm btn-ghost" style="width:100%;" onclick="goTo('news')"><span data-en>View
                        Events</span><span data-tr>Etkinlikler</span></button>
            </div>
            
            <!-- Data Panel Dropdown -->
            <div class="sidebar-data-panel">
                <button class="sidebar-data-toggle" onclick="toggleDataPanel()">
                    <div class="sidebar-data-toggle-left">
                        <i class="fa-solid fa-database"></i>
                        <span data-en>Data Panel</span><span data-tr>Veri Paneli</span>
                    </div>
                    <div class="sidebar-data-toggle-right">
                        <span class="data-status-dot" id="dataStatusDot"></span>
                        <i class="fa-solid fa-chevron-up" id="dataPanelIcon"></i>
                    </div>
                </button>
                <div class="sidebar-data-content" id="dataPanelContent">
                    <div class="data-info-row">
                        <span class="data-info-label"><span data-en>Last Updated</span><span data-tr>Son Güncelleme</span></span>
                        <span class="data-info-value" id="sidebarLastUpdated">â€”</span>
                    </div>
                    <div class="data-actions-row">
                        <button class="btn btn-ghost btn-sm" onclick="refreshData()" id="sidebarRefreshBtn">
                            <i class="fa-solid fa-rotate"></i> <span data-en>Refresh</span><span data-tr>Yenile</span>
                        </button>
                        <button class="btn btn-ghost btn-sm" onclick="toggleChangeLog()">
                            <i class="fa-solid fa-list"></i> <span data-en>Log</span><span data-tr>Kayıt</span>
                        </button>
                    </div>
                    <div class="data-changelog" id="sidebarChangeLog" style="display:none;">
                        <div class="data-changelog-header">
                            <span><i class="fa-solid fa-clock-rotate-left"></i> <span data-en>Changes</span><span data-tr>Değişiklikler</span></span>
                            <button class="btn btn-ghost btn-xs" onclick="clearChangeHistory()" title="Reset">
                                <i class="fa-solid fa-trash-can"></i>
                            </button>
                        </div>
                        <div class="data-changelog-content" id="sidebarLogContent">
                            <span class="text-muted"><span data-en>No changes</span><span data-tr>Değişiklik yok</span></span>
                        </div>
                    </div>
                    <div class="data-admin-row">
                        <button class="btn btn-ghost btn-sm" onclick="openAdminLogin()" style="width:100%;">
                            <i class="fa-solid fa-shield-halved"></i> <span data-en>Admin Access</span><span data-tr>Yönetici Erişimi</span>
                        </button>
                    </div>
                </div>
            </div>
        </aside>

        <main id="mainContent">

            <!-- HOME PAGE -->
            <div id="home" class="page active">
                <div class="hero">
                    <div class="hero-content">
                        <h1 id="heroTitle">Loading...</h1>
                        <p id="heroSubtitle">Loading department information...</p>
                        <div class="hero-actions">
                            <button class="btn btn-primary btn-lg" onclick="goTo('research')"><i
                                    class="fa-solid fa-flask"></i> <span data-en>Research</span><span
                                    data-tr>Araştırma</span></button>
                            <button class="btn btn-primary btn-lg" onclick="goTo('projects')"><i
                                    class="fa-solid fa-rocket"></i> <span data-en>Projects</span><span
                                    data-tr>Projeler</span></button>
                            <button class="btn btn-ghost btn-lg"><i class="fa-solid fa-play"></i> <span
                                    data-en>Video</span><span data-tr>Video</span></button>
                        </div>
                    </div>
                </div>

                <div class="stats-grid" id="statsGrid">
                    <div class="stat-card skeleton" style="height:70px;"></div>
                    <div class="stat-card skeleton" style="height:70px;"></div>
                    <div class="stat-card skeleton" style="height:70px;"></div>
                    <div class="stat-card skeleton" style="height:70px;"></div>
                    <div class="stat-card skeleton" style="height:70px;"></div>
                    <div class="stat-card skeleton" style="height:70px;"></div>
                </div>

                <div class="quick-links" id="quickLinks">
                    <a class="quick-link" onclick="goTo('projects')"><i class="fa-solid fa-lightbulb"></i><span
                            data-en>Capstone</span><span data-tr>Bitirme</span></a>
                    <a class="quick-link" onclick="goTo('courses')"><i class="fa-solid fa-calendar-check"></i><span
                            data-en>Courses</span><span data-tr>Dersler</span></a>
                    <a class="quick-link" onclick="goTo('labs')"><i class="fa-solid fa-flask-vial"></i><span
                            data-en>Labs</span><span data-tr>Lablar</span></a>
                    <a class="quick-link" onclick="goTo('news')"><i class="fa-solid fa-video"></i><span
                            data-en>Seminars</span><span data-tr>Seminerler</span></a>
                    <a class="quick-link" onclick="goTo('jobs')"><i class="fa-solid fa-briefcase"></i><span
                            data-en>Jobs</span><span data-tr>İşler</span></a>
                    <a class="quick-link" onclick="goTo('contact')"><i class="fa-solid fa-file-arrow-down"></i><span
                            data-en>Contact</span><span data-tr>İletişim</span></a>
                </div>

                <section class="section">
                    <div class="section-header">
                        <h2><span data-en>Featured Research</span><span data-tr>Öne Çıkan Araştırma</span></h2>
                        <button class="btn btn-ghost btn-sm" onclick="goTo('research')"><span data-en>View
                                All</span><span data-tr>Tümü</span> →</button>
                    </div>
                    <div class="card-grid" id="featuredResearch">
                        <div class="card skeleton" style="height:260px;"></div>
                        <div class="card skeleton" style="height:260px;"></div>
                        <div class="card skeleton" style="height:260px;"></div>
                    </div>
                </section>

                <section class="section">
                    <div class="section-header">
                        <h2><span data-en>Student Projects</span><span data-tr>Öğrenci Projeleri</span></h2>
                        <button class="btn btn-ghost btn-sm" onclick="goTo('projects')"><span data-en>All
                                Projects</span><span data-tr>Tüm Projeler</span> →</button>
                    </div>
                    <div class="card-grid card-grid-sm" id="featuredProjects">
                        <div class="project-card skeleton" style="height:220px;"></div>
                        <div class="project-card skeleton" style="height:220px;"></div>
                        <div class="project-card skeleton" style="height:220px;"></div>
                        <div class="project-card skeleton" style="height:220px;"></div>
                    </div>
                </section>

                <section class="section">
                    <div class="section-header">
                        <h2><span data-en>Latest News</span><span data-tr>Son Haberler</span></h2>
                        <button class="btn btn-ghost btn-sm" onclick="goTo('news')"><span data-en>All News</span><span
                                data-tr>Tüm Haberler</span> →</button>
                    </div>
                    <div class="card-grid" id="latestNews">
                        <div class="news-card skeleton" style="height:220px;"></div>
                        <div class="news-card skeleton" style="height:220px;"></div>
                        <div class="news-card skeleton" style="height:220px;"></div>
                    </div>
                </section>

                <section class="section">
                    <div class="section-header">
                        <h2><span data-en>Upcoming Events</span><span data-tr>Yaklaşan Etkinlikler</span></h2>
                    </div>
                    <div class="timeline" id="upcomingEvents">
                        <div class="timeline-item">
                            <div class="timeline-card skeleton" style="height:80px;"></div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-card skeleton" style="height:80px;"></div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-card skeleton" style="height:80px;"></div>
                        </div>
                    </div>
                </section>

                <section class="section">
                    <div class="section-header">
                        <h2><span data-en>Industry Partners</span><span data-tr>Sanayi Ortakları</span></h2>
                    </div>
                    <div class="partners-row" id="homePartners">
                        <div class="skeleton" style="width:80px; height:24px;"></div>
                        <div class="skeleton" style="width:80px; height:24px;"></div>
                        <div class="skeleton" style="width:80px; height:24px;"></div>
                        <div class="skeleton" style="width:80px; height:24px;"></div>
                    </div>
                </section>
            </div>

            <!-- ABOUT PAGE -->
            <div id="about" class="page">
                <div class="page-header">
                    <h1><span data-en>About the Department</span><span data-tr>Bölüm Hakkında</span></h1>
                    <p class="subtitle" id="aboutSubtitle">Loading...</p>
                </div>
                <div id="aboutContent" class="two-cols">
                    <div class="loading"><i class="fa-solid fa-spinner"></i> Loading content...</div>
                </div>
            </div>

            <!-- NEWS PAGE -->
            <div id="news" class="page">
                <div class="page-header">
                    <h1><span data-en>News & Events</span><span data-tr>Haberler & Etkinlikler</span></h1>
                    <p class="subtitle"><span data-en>Latest updates from the department</span><span data-tr>Bölümden
                            son güncellemeler</span></p>
                </div>
                <div class="card-grid" id="allNews">
                    <div class="news-card skeleton" style="height:220px;"></div>
                    <div class="news-card skeleton" style="height:220px;"></div>
                    <div class="news-card skeleton" style="height:220px;"></div>
                </div>
                <h2 style="margin-top:2rem;"><span data-en>Upcoming Events</span><span data-tr>Yaklaşan
                        Etkinlikler</span></h2>
                <div class="timeline" id="allEvents">
                    <div class="timeline-item">
                        <div class="timeline-card skeleton" style="height:80px;"></div>
                    </div>
                </div>
            </div>

            <!-- RESEARCH PAGE -->
            <div id="research" class="page">
                <div class="page-header">
                    <h1><span data-en>Research Groups</span><span data-tr>Araştırma Grupları</span></h1>
                    <p class="subtitle"><span data-en>Collaborative teams advancing engineering</span><span
                            data-tr>Mühendisliği ileriye taşıyan ekipler</span></p>
                </div>
                <div id="researchGroups">
                    <div class="research-card skeleton" style="height:150px;"></div>
                    <div class="research-card skeleton" style="height:150px;"></div>
                </div>
            </div>

            <!-- PUBLICATIONS PAGE -->
            <div id="publications" class="page">
                <div class="page-header">
                    <h1><span data-en>Publications</span><span data-tr>Yayınlar</span></h1>
                    <p class="subtitle"><span data-en>Recent scholarly work</span><span data-tr>Son akademik
                            çalışmalar</span></p>
                </div>
                <div id="publicationsList">
                    <div class="pub-item skeleton" style="height:90px;"></div>
                    <div class="pub-item skeleton" style="height:90px;"></div>
                    <div class="pub-item skeleton" style="height:90px;"></div>
                </div>
            </div>

            <!-- LABS PAGE -->
            <div id="labs" class="page">
                <div class="page-header">
                    <h1><span data-en>Laboratories</span><span data-tr>Laboratuvarlar</span></h1>
                    <p class="subtitle"><span data-en>State-of-the-art facilities</span><span data-tr>Modern
                            tesisler</span></p>
                </div>
                <div class="card-grid" id="labsList">
                    <div class="card skeleton" style="height:250px;"></div>
                    <div class="card skeleton" style="height:250px;"></div>
                </div>
            </div>

            <!-- FACULTY PAGE -->
            <div id="faculty" class="page">
                <div class="page-header">
                    <h1><span data-en>Faculty Directory</span><span data-tr>Akademik Kadro</span></h1>
                    <p class="subtitle"><span data-en>Our researchers and educators</span><span
                            data-tr>Araştırmacılarımız ve eğitimcilerimiz</span></p>
                </div>
                <div id="facultyList">
                    <div class="faculty-grid" id="facultyGrid">
                        <div class="faculty-card skeleton" style="height:180px;"></div>
                        <div class="faculty-card skeleton" style="height:180px;"></div>
                        <div class="faculty-card skeleton" style="height:180px;"></div>
                    </div>
                </div>
            </div>

            <!-- STUDENTS PAGE -->
            <div id="students" class="page">
                <div class="page-header">
                    <h1><span data-en>Graduate Students</span><span data-tr>Lisansüstü Öğrenciler</span></h1>
                    <p class="subtitle"><span data-en>Current MSc and PhD students</span><span data-tr>YL ve Doktora
                            öğrencileri</span></p>
                </div>
                <div class="table-wrapper">
                    <table class="data-table" id="studentsTable">
                        <thead>
                            <tr>
                                <th><span data-en>Name</span><span data-tr>İsim</span></th>
                                <th><span data-en>Program</span><span data-tr>Program</span></th>
                                <th><span data-en>Advisor</span><span data-tr>Danışman</span></th>
                                <th><span data-en>Research Topic</span><span data-tr>Araştırma</span></th>
                                <th><span data-en>Year</span><span data-tr>Yıl</span></th>
                            </tr>
                        </thead>
                        <tbody id="studentsBody">
                            <tr>
                                <td colspan="5" class="loading"><i class="fa-solid fa-spinner"></i> Loading...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- ALUMNI PAGE -->
            <div id="alumni" class="page">
                <div class="page-header">
                    <h1><span data-en>Alumni</span><span data-tr>Mezunlar</span></h1>
                    <p class="subtitle"><span data-en>Where our graduates work</span><span data-tr>Mezunlarımız nerede
                            çalışıyor</span></p>
                </div>
                <div class="stats-grid" id="alumniStats">
                    <div class="stat-card skeleton" style="height:70px;"></div>
                    <div class="stat-card skeleton" style="height:70px;"></div>
                    <div class="stat-card skeleton" style="height:70px;"></div>
                </div>
                <h2><span data-en>Notable Alumni</span><span data-tr>Öne Çıkan Mezunlar</span></h2>
                <div class="card-grid card-grid-sm" id="alumniList">
                    <div class="card-compact skeleton" style="height:60px;"></div>
                    <div class="card-compact skeleton" style="height:60px;"></div>
                </div>
            </div>

            <!-- PROJECTS PAGE -->
            <div id="projects" class="page">
                <div class="page-header">
                    <h1><span data-en>Student Projects</span><span data-tr>Öğrenci Projeleri</span></h1>
                    <p class="subtitle"><span data-en>Capstone projects and competitions</span><span data-tr>Bitirme
                            projeleri ve yarışmalar</span></p>
                </div>
                <div class="card-grid card-grid-sm" id="projectsList">
                    <div class="project-card skeleton" style="height:220px;"></div>
                    <div class="project-card skeleton" style="height:220px;"></div>
                    <div class="project-card skeleton" style="height:220px;"></div>
                </div>
            </div>

            <!-- COURSES PAGE -->
            <div id="courses" class="page">
                <div class="page-header">
                    <h1><span data-en>Course Catalog</span><span data-tr>Ders Kataloğu</span></h1>
                    <p class="subtitle"><span data-en>Undergraduate and graduate courses</span><span data-tr>Lisans ve
                            lisansüstü dersler</span></p>
                </div>
                <div id="coursesList">
                    <div class="course-item skeleton" style="height:60px;"></div>
                    <div class="course-item skeleton" style="height:60px;"></div>
                    <div class="course-item skeleton" style="height:60px;"></div>
                </div>
            </div>

            <!-- JOBS PAGE -->
            <div id="jobs" class="page">
                <div class="page-header">
                    <h1><span data-en>Jobs & Internships</span><span data-tr>İş & Staj</span></h1>
                    <p class="subtitle"><span data-en>Career opportunities</span><span data-tr>Kariyer fırsatları</span>
                    </p>
                </div>
                <div id="jobsList">
                    <div class="card-compact skeleton" style="height:70px;"></div>
                    <div class="card-compact skeleton" style="height:70px;"></div>
                </div>
            </div>

            <!-- PARTNERS PAGE -->
            <div id="partners" class="page">
                <div class="page-header">
                    <h1><span data-en>Partners</span><span data-tr>Ortaklar</span></h1>
                    <p class="subtitle"><span data-en>Industry and academic collaborations</span><span data-tr>Sanayi ve
                            akademik işbirlikleri</span></p>
                </div>
                <h2><span data-en>Industry Partners</span><span data-tr>Sanayi Ortakları</span></h2>
                <div class="partners-row" id="industryPartners">
                    <div class="skeleton" style="width:80px; height:28px;"></div>
                </div>
                <h2 style="margin-top:2rem;"><span data-en>Academic Collaborations</span><span data-tr>Akademik
                        İşbirlikleri</span></h2>
                <div id="academicPartners">
                    <div class="card-compact skeleton" style="height:60px;"></div>
                </div>
            </div>

            <!-- PROFILE PAGE -->
            <div id="profile" class="page">
                <div class="page-header" style="display:flex; justify-content:space-between; align-items:flex-end;">
                    <div>
                        <button class="btn btn-ghost btn-sm" onclick="goTo('faculty')" style="margin-bottom:1rem;">
                            <i class="fa-solid fa-arrow-left"></i> <span data-en>Back to Faculty</span><span
                                data-tr>Kadroya Dön</span>
                        </button>
                        <h1 id="profName">Name Loading...</h1>
                        <p class="subtitle" id="profTitle">Title...</p>
                    </div>
                </div>

                <div class="profile-layout">
                    <aside class="profile-sidebar">
                        <div class="profile-photo-container">
                            <img id="profPhoto"
                                src="https://ui-avatars.com/api/?name=F&background=6366f1&color=fff&size=400"
                                alt="Faculty">
                        </div>
                        <div class="profile-contact-list" id="profLinks">
                            <!-- Links injected by JS -->
                        </div>
                    </aside>

                    <main class="profile-main">
                        <div id="profBioSection">
                            <h2><span data-en>Biography</span><span data-tr>Biyografi</span></h2>
                            <div class="profile-bio" id="profBio">...</div>
                        </div>

                        <div class="profile-meta-grid">
                            <div class="meta-item">
                                <label><span data-en>Research Areas</span><span data-tr>Araştırma
                                        Alanları</span></label>
                                <p id="profResearch">...</p>
                            </div>
                            <div class="meta-item" id="profEducationSection">
                                <label><span data-en>Education</span><span data-tr>Eğitim</span></label>
                                <p id="profEducation">...</p>
                            </div>
                            <div class="meta-item" id="profOfficeSection">
                                <label><span data-en>Office</span><span data-tr>Ofis</span></label>
                                <p id="profOffice">...</p>
                            </div>
                        </div>

                        <div id="profHonorsSection">
                            <h2><span data-en>Honors & Awards</span><span data-tr>Ödüller</span></h2>
                            <p id="profHonors" class="profile-bio">...</p>
                        </div>
                        
                        <div id="profPublicationsSection" style="display:none;">
                            <h2><span data-en>Publications</span><span data-tr>Yayınlar</span></h2>
                            <div id="profPublications" class="profile-related-list"></div>
                        </div>
                        
                        <div id="profCoursesSection" style="display:none;">
                            <h2><span data-en>Courses Taught</span><span data-tr>Verilen Dersler</span></h2>
                            <div id="profCourses" class="profile-related-list"></div>
                        </div>
                        
                        <div id="profResearchSection" style="display:none;">
                            <h2><span data-en>Research Groups</span><span data-tr>Araştırma Grupları</span></h2>
                            <div id="profResearchGroups" class="profile-related-list"></div>
                        </div>
                        
                        <div id="profStudentsSection" style="display:none;">
                            <h2><span data-en>Students Advised</span><span data-tr>Danışmanlık Yapılan Öğrenciler</span></h2>
                            <div id="profStudents" class="profile-related-list"></div>
                        </div>
                        
                        <div id="profProjectsSection" style="display:none;">
                            <h2><span data-en>Projects</span><span data-tr>Projeler</span></h2>
                            <div id="profProjects" class="profile-related-list"></div>
                        </div>
                    </main>
                </div>
            </div>

            <!-- CONTACT PAGE -->
            <div id="contact" class="page">
                <div class="page-header">
                    <h1><span data-en>Contact</span><span data-tr>İletişim</span></h1>
                    <p class="subtitle"><span data-en>Get in touch with us</span><span data-tr>Bize ulaşın</span></p>
                </div>
                <div class="two-cols" id="contactContent">
                    <div class="loading"><i class="fa-solid fa-spinner"></i> Loading...</div>
                </div>
            </div>

            <!-- NEWS DETAIL PAGE -->
            <div id="news-detail" class="page">
                <div class="detail-page">
                    <button onclick="goTo('news')" class="btn btn-ghost btn-sm detail-back">
                        <i class="fa-solid fa-arrow-left"></i> <span data-en>Back to News</span><span data-tr>Haberlere Dön</span>
                    </button>
                    
                    <div class="detail-card">
                        <div class="detail-image" id="newsDetailImage"></div>
                        <div class="detail-body">
                            <div class="detail-meta">
                                <span class="tag" id="newsDetailCategory">News</span>
                                <span class="detail-date"><i class="fa-solid fa-calendar"></i> <span id="newsDetailDate"></span></span>
                                <span class="detail-author"><i class="fa-solid fa-user"></i> <span id="newsDetailAuthor"></span></span>
                            </div>
                            <h1 class="detail-title" id="newsDetailTitle">Loading...</h1>
                            <div class="detail-content" id="newsDetailContent"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- EVENT DETAIL PAGE -->
            <div id="event-detail" class="page">
                <div class="detail-page">
                    <button onclick="goTo('events')" class="btn btn-ghost btn-sm detail-back">
                        <i class="fa-solid fa-arrow-left"></i> <span data-en>Back to Events</span><span data-tr>Etkinliklere Dön</span>
                    </button>
                    
                    <div class="detail-card">
                        <div class="detail-body">
                            <div class="detail-meta">
                                <span class="tag" id="eventDetailType">Event</span>
                            </div>
                            <h1 class="detail-title" id="eventDetailTitle">Loading...</h1>
                            
                            <div class="detail-info-grid">
                                <div class="detail-info-item">
                                    <i class="fa-solid fa-calendar"></i>
                                    <div>
                                        <span class="detail-info-label"><span data-en>Date</span><span data-tr>Tarih</span></span>
                                        <span class="detail-info-value" id="eventDetailDate"></span>
                                    </div>
                                </div>
                                <div class="detail-info-item">
                                    <i class="fa-solid fa-clock"></i>
                                    <div>
                                        <span class="detail-info-label"><span data-en>Time</span><span data-tr>Saat</span></span>
                                        <span class="detail-info-value" id="eventDetailTime"></span>
                                    </div>
                                </div>
                                <div class="detail-info-item">
                                    <i class="fa-solid fa-location-dot"></i>
                                    <div>
                                        <span class="detail-info-label"><span data-en>Location</span><span data-tr>Konum</span></span>
                                        <span class="detail-info-value" id="eventDetailLocation"></span>
                                    </div>
                                </div>
                            </div>
                            
                            <div id="eventDetailSpeakerBox" class="detail-speaker-box" style="display:none;">
                                <i class="fa-solid fa-user-tie"></i>
                                <div>
                                    <span class="detail-info-label"><span data-en>Speaker</span><span data-tr>Konuşmacı</span></span>
                                    <span class="detail-info-value" id="eventDetailSpeaker"></span>
                                </div>
                            </div>
                            
                            <div class="detail-content" id="eventDetailContent"></div>
                            
                            <div id="eventRegisterBox" class="detail-actions" style="display:none;">
                                <a href="#" id="eventRegisterLink" class="btn btn-accent" target="_blank">
                                    <i class="fa-solid fa-calendar-plus"></i> <span data-en>Register Now</span><span data-tr>Şimdi Kayıt Ol</span>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- PROJECT DETAIL PAGE -->
            <div id="project-detail" class="page">
                <div class="detail-page">
                    <button onclick="goTo('projects')" class="btn btn-ghost btn-sm detail-back">
                        <i class="fa-solid fa-arrow-left"></i> <span data-en>Back to Projects</span><span data-tr>Projelere Dön</span>
                    </button>
                    
                    <div class="detail-card">
                        <div class="detail-image" id="projectDetailImage"></div>
                        <div class="detail-body">
                            <div class="detail-meta">
                                <span class="tag" id="projectDetailCategory">Capstone</span>
                                <span class="tag tag-purple" id="projectDetailYear">2024</span>
                                <span class="tag tag-green" id="projectDetailAward" style="display:none;">
                                    <i class="fa-solid fa-trophy"></i> <span id="projectAwardText"></span>
                                </span>
                            </div>
                            <h1 class="detail-title" id="projectDetailTitle">Loading...</h1>
                            
                            <div class="detail-info-grid">
                                <div class="detail-info-item">
                                    <i class="fa-solid fa-users"></i>
                                    <div>
                                        <span class="detail-info-label"><span data-en>Team</span><span data-tr>Ekip</span></span>
                                        <span class="detail-info-value" id="projectDetailTeam"></span>
                                    </div>
                                </div>
                                <div class="detail-info-item">
                                    <i class="fa-solid fa-user-tie"></i>
                                    <div>
                                        <span class="detail-info-label"><span data-en>Advisor</span><span data-tr>Danışman</span></span>
                                        <span class="detail-info-value" id="projectDetailAdvisor"></span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="detail-content" id="projectDetailContent"></div>
                            
                            <div class="detail-tech-box">
                                <h4><i class="fa-solid fa-code"></i> <span data-en>Technologies</span><span data-tr>Teknolojiler</span></h4>
                                <div id="projectDetailTech" class="detail-tech-tags"></div>
                            </div>
                            
                            <div id="projectGithubBox" class="detail-actions" style="display:none;">
                                <a href="#" id="projectGithubLink" class="btn btn-ghost" target="_blank">
                                    <i class="fa-brands fa-github"></i> <span data-en>View on GitHub</span><span data-tr>GitHub'da Görüntüle</span>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- LAB DETAIL PAGE -->
            <div id="lab-detail" class="page">
                <div class="detail-page">
                    <button onclick="goTo('labs')" class="btn btn-ghost btn-sm detail-back">
                        <i class="fa-solid fa-arrow-left"></i> <span data-en>Back to Labs</span><span data-tr>Lablara Dön</span>
                    </button>
                    
                    <div class="detail-card">
                        <div class="detail-image" id="labDetailImage"></div>
                        <div class="detail-body">
                            <div class="detail-meta">
                                <span class="tag" id="labDetailType">Lab</span>
                            </div>
                            <h1 class="detail-title" id="labDetailTitle">Loading...</h1>
                            
                            <div class="detail-info-grid">
                                <div class="detail-info-item">
                                    <i class="fa-solid fa-door-open"></i>
                                    <div>
                                        <span class="detail-info-label"><span data-en>Room</span><span data-tr>Oda</span></span>
                                        <span class="detail-info-value" id="labDetailRoom"></span>
                                    </div>
                                </div>
                                <div class="detail-info-item">
                                    <i class="fa-solid fa-user-tie"></i>
                                    <div>
                                        <span class="detail-info-label"><span data-en>Manager</span><span data-tr>Yönetici</span></span>
                                        <span class="detail-info-value" id="labDetailManager"></span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="detail-content" id="labDetailContent"></div>
                            
                            <div class="detail-equipment-box">
                                <h4><i class="fa-solid fa-wrench"></i> <span data-en>Equipment</span><span data-tr>Ekipman</span></h4>
                                <p id="labDetailEquipment"></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- RESEARCH DETAIL PAGE -->
            <div id="research-detail" class="page">
                <div class="detail-page">
                    <button onclick="goTo('research')" class="btn btn-ghost btn-sm detail-back">
                        <i class="fa-solid fa-arrow-left"></i> <span data-en>Back to Research</span><span data-tr>Araştırmaya Dön</span>
                    </button>
                    
                    <div class="detail-card">
                        <div class="detail-image" id="researchDetailImage"></div>
                        <div class="detail-body">
                            <div class="detail-meta">
                                <span class="tag tag-green" id="researchDetailType">Research</span>
                            </div>
                            <h1 class="detail-title" id="researchDetailTitle">Loading...</h1>
                            <p class="detail-subtitle" id="researchDetailFocus"></p>
                            
                            <div class="detail-info-grid">
                                <div class="detail-info-item">
                                    <i class="fa-solid fa-user-tie"></i>
                                    <div>
                                        <span class="detail-info-label"><span data-en>Lead Researcher</span><span data-tr>Araştırma Lideri</span></span>
                                        <span class="detail-info-value" id="researchDetailLead"></span>
                                    </div>
                                </div>
                                <div class="detail-info-item">
                                    <i class="fa-solid fa-users"></i>
                                    <div>
                                        <span class="detail-info-label"><span data-en>Team Size</span><span data-tr>Ekip Büyüklüğü</span></span>
                                        <span class="detail-info-value" id="researchDetailMembers"></span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="detail-content" id="researchDetailContent"></div>
                            
                            <div class="detail-equipment-box" id="researchPublicationsBox">
                                <h4><i class="fa-solid fa-book"></i> <span data-en>Key Publications</span><span data-tr>Önemli Yayınlar</span></h4>
                                <p id="researchDetailPublications"></p>
                            </div>
                            
                            <div class="detail-equipment-box" id="researchProjectsBox">
                                <h4><i class="fa-solid fa-flask"></i> <span data-en>Active Projects</span><span data-tr>Aktif Projeler</span></h4>
                                <p id="researchDetailProjects"></p>
                            </div>
                            
                            <div class="detail-equipment-box" id="researchEquipmentBox">
                                <h4><i class="fa-solid fa-wrench"></i> <span data-en>Equipment & Tools</span><span data-tr>Ekipman ve Araçlar</span></h4>
                                <p id="researchDetailEquipment"></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- JOB DETAIL PAGE -->
            <div id="job-detail" class="page">
                <div class="detail-page">
                    <button onclick="goTo('jobs')" class="btn btn-ghost btn-sm detail-back">
                        <i class="fa-solid fa-arrow-left"></i> <span data-en>Back to Jobs</span><span data-tr>İş İlanlarına Dön</span>
                    </button>
                    
                    <div class="detail-card">
                        <div class="detail-body">
                            <div class="detail-meta">
                                <span class="tag" id="jobDetailType">Full-time</span>
                            </div>
                            <h1 class="detail-title" id="jobDetailTitle">Loading...</h1>
                            
                            <div class="detail-info-grid">
                                <div class="detail-info-item">
                                    <i class="fa-solid fa-building"></i>
                                    <div>
                                        <span class="detail-info-label"><span data-en>Company</span><span data-tr>Şirket</span></span>
                                        <span class="detail-info-value" id="jobDetailCompany"></span>
                                    </div>
                                </div>
                                <div class="detail-info-item">
                                    <i class="fa-solid fa-location-dot"></i>
                                    <div>
                                        <span class="detail-info-label"><span data-en>Location</span><span data-tr>Konum</span></span>
                                        <span class="detail-info-value" id="jobDetailLocation"></span>
                                    </div>
                                </div>
                                <div class="detail-info-item" id="jobSalaryItem" style="display:none;">
                                    <i class="fa-solid fa-money-bill"></i>
                                    <div>
                                        <span class="detail-info-label"><span data-en>Salary</span><span data-tr>Maaş</span></span>
                                        <span class="detail-info-value" id="jobDetailSalary"></span>
                                    </div>
                                </div>
                                <div class="detail-info-item" id="jobDeadlineItem" style="display:none;">
                                    <i class="fa-solid fa-calendar-xmark"></i>
                                    <div>
                                        <span class="detail-info-label"><span data-en>Deadline</span><span data-tr>Son Tarih</span></span>
                                        <span class="detail-info-value" id="jobDetailDeadline"></span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="detail-content" id="jobDetailContent"></div>
                            
                            <div id="jobApplyBox" class="detail-actions" style="display:none;">
                                <a href="#" id="jobApplyLink" class="btn btn-accent" target="_blank">
                                    <i class="fa-solid fa-paper-plane"></i> <span data-en>Apply Now</span><span data-tr>Şimdi Başvur</span>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </main>
    </div>

    <script>
        // ═══════════════════════════════════════════════════════════════════════════
        // DATA STORE
        // ═══════════════════════════════════════════════════════════════════════════
        const DATA = {
            settings: [],
            news: [],
            events: [],
            faculty: [],
            research: [],
            publications: [],
            courses: [],
            projects: [],
            labs: [],
            jobs: [],
            alumni: [],
            partners: [],
            students: []
        };

        // ═══════════════════════════════════════════════════════════════════════════
        // SMART CHANGE TRACKING SYSTEM
        // ═══════════════════════════════════════════════════════════════════════════
        
        // Store previous data snapshots for comparison
        let PREVIOUS_DATA = JSON.parse(localStorage.getItem('previousDataSnapshot') || '{}');
        
        // UPDATE LOG for tracking sheet changes
        const UPDATE_LOG = [];
        
        // Sheet display names (TR)
        const SHEET_NAMES_TR = {
            'Settings': 'Ayarlar',
            'News': 'Haberler',
            'Events': 'Etkinlikler',
            'Faculty': 'Akademisyenler',
            'Research': 'Araştırma Grupları',
            'Publications': 'Yayınlar',
            'Courses': 'Dersler',
            'Projects': 'Projeler',
            'Labs': 'Laboratuvarlar',
            'Jobs': 'İş İlanları',
            'Alumni': 'Mezunlar',
            'Partners': 'Ortaklar',
            'Students': 'Öğrenciler'
        };
        
        // Get unique identifier for a record
        function getRecordId(record, sheetName) {
            // Try different ID fields based on sheet type
            return record.id || record.name || record.title || record.title_en || 
                   record.name_en || record.company || record.code || 
                   JSON.stringify(record).substring(0, 50);
        }
        
        // Get display title for a record
        function getRecordTitle(record, lang) {
            const title = record.title_tr || record.title_en || record.title ||
                         record.name_tr || record.name_en || record.name ||
                         record.company || record.code || record.id || '?';
            return title.length > 30 ? title.substring(0, 30) + '...' : title;
        }
        
        // Create a hash/fingerprint of a record for comparison
        function hashRecord(record) {
            const str = JSON.stringify(record);
            let hash = 0;
            for (let i = 0; i < str.length; i++) {
                const char = str.charCodeAt(i);
                hash = ((hash << 5) - hash) + char;
                hash = hash & hash;
            }
            return hash.toString(36);
        }
        
        // Compare two datasets and find differences
        function compareData(oldData, newData, sheetName, lang) {
            const changes = {
                added: [],
                removed: [],
                modified: [],
                unchanged: 0
            };
            
            if (!oldData || !Array.isArray(oldData)) {
                // First load - all items are new
                if (newData && Array.isArray(newData)) {
                    changes.added = newData.map(r => getRecordTitle(r, lang));
                }
                return changes;
            }
            
            if (!newData || !Array.isArray(newData)) {
                return changes;
            }
            
            // Create maps for comparison
            const oldMap = new Map();
            const newMap = new Map();
            
            oldData.forEach(record => {
                const id = getRecordId(record, sheetName);
                oldMap.set(id, { record, hash: hashRecord(record) });
            });
            
            newData.forEach(record => {
                const id = getRecordId(record, sheetName);
                newMap.set(id, { record, hash: hashRecord(record) });
            });
            
            // Find added and modified items
            newMap.forEach((value, id) => {
                const oldItem = oldMap.get(id);
                if (!oldItem) {
                    changes.added.push(getRecordTitle(value.record, lang));
                } else if (oldItem.hash !== value.hash) {
                    // Find what changed
                    const changedFields = findChangedFields(oldItem.record, value.record);
                    changes.modified.push({
                        title: getRecordTitle(value.record, lang),
                        fields: changedFields
                    });
                } else {
                    changes.unchanged++;
                }
            });
            
            // Find removed items
            oldMap.forEach((value, id) => {
                if (!newMap.has(id)) {
                    changes.removed.push(getRecordTitle(value.record, lang));
                }
            });
            
            return changes;
        }
        
        // Find which fields changed between two records
        function findChangedFields(oldRecord, newRecord) {
            const changed = [];
            const fieldLabels = {
                title_en: 'başlık', title_tr: 'başlık', title: 'başlık',
                name_en: 'isim', name_tr: 'isim', name: 'isim',
                email: 'e-posta', phone: 'telefon',
                description_en: 'açıklama', description_tr: 'açıklama',
                content_en: 'içerik', content_tr: 'içerik',
                date: 'tarih', time: 'saat', location: 'konum',
                image: 'görsel', photo: 'fotoğraf',
                position_en: 'pozisyon', position_tr: 'pozisyon',
                department: 'bölüm', office: 'ofis',
                salary: 'maaş', deadline: 'son tarih',
                yok_cv: 'YÖK CV', website: 'web sitesi'
            };
            
            const allKeys = new Set([...Object.keys(oldRecord), ...Object.keys(newRecord)]);
            
            allKeys.forEach(key => {
                const oldVal = oldRecord[key];
                const newVal = newRecord[key];
                
                if (JSON.stringify(oldVal) !== JSON.stringify(newVal)) {
                    const label = fieldLabels[key] || key;
                    changed.push(label);
                }
            });
            
            return changed.slice(0, 3); // Max 3 fields to show
        }
        
        // Compare settings object with detailed value tracking
        function compareSettings(oldSettings, newSettings, lang) {
            const changes = {
                added: [],
                removed: [],
                modified: [],
                unchanged: 0
            };
            
            // Friendly names for settings keys (TR/EN)
            const settingLabels = {
                site_name: { en: 'Site Name', tr: 'Site Adı' },
                hero_title_en: { en: 'Hero Title (EN)', tr: 'Ana Başlık (EN)' },
                hero_title_tr: { en: 'Hero Title (TR)', tr: 'Ana Başlık (TR)' },
                hero_subtitle_en: { en: 'Hero Subtitle (EN)', tr: 'Alt Başlık (EN)' },
                hero_subtitle_tr: { en: 'Hero Subtitle (TR)', tr: 'Alt Başlık (TR)' },
                stat_faculty: { en: 'Faculty Count', tr: 'Akademisyen Sayısı' },
                stat_students: { en: 'Student Count', tr: 'Öğrenci Sayısı' },
                stat_publications: { en: 'Publications', tr: 'Yayın Sayısı' },
                stat_grants: { en: 'Grants', tr: 'Hibe Miktarı' },
                stat_employment: { en: 'Employment Rate', tr: 'İstihdam Oranı' },
                stat_partners: { en: 'Partner Count', tr: 'Ortak Sayısı' },
                phone: { en: 'Phone', tr: 'Telefon' },
                email: { en: 'Email', tr: 'E-posta' },
                hours: { en: 'Office Hours', tr: 'Çalışma Saatleri' },
                chair: { en: 'Department Chair', tr: 'Bölüm Başkanı' },
                grad_coordinator: { en: 'Graduate Coordinator', tr: 'Lisansüstü Koordinatörü' },
                mission_en: { en: 'Mission (EN)', tr: 'Misyon (EN)' },
                mission_tr: { en: 'Mission (TR)', tr: 'Misyon (TR)' },
                vision_en: { en: 'Vision (EN)', tr: 'Vizyon (EN)' },
                vision_tr: { en: 'Vision (TR)', tr: 'Vizyon (TR)' },
                about_subtitle_en: { en: 'About Subtitle (EN)', tr: 'Hakkında Alt Başlık (EN)' },
                about_subtitle_tr: { en: 'About Subtitle (TR)', tr: 'Hakkında Alt Başlık (TR)' },
                accreditation_en: { en: 'Accreditation (EN)', tr: 'Akreditasyon (EN)' },
                accreditation_tr: { en: 'Accreditation (TR)', tr: 'Akreditasyon (TR)' },
                accreditation_status: { en: 'Accreditation Status', tr: 'Akreditasyon Durumu' },
                alumni_total: { en: 'Total Alumni', tr: 'Toplam Mezun' },
                alumni_employed: { en: 'Alumni Employed', tr: 'İstihdam Edilen Mezun' },
                alumni_startups: { en: 'Alumni Startups', tr: 'Mezun Girişimleri' }
            };
            
            const getLabel = (key) => {
                const label = settingLabels[key];
                if (label) {
                    return lang === 'tr' ? label.tr : label.en;
                }
                return key;
            };
            
            if (!oldSettings || Object.keys(oldSettings).length === 0) {
                changes.added = Object.keys(newSettings || {}).map(k => getLabel(k));
                return changes;
            }
            
            const oldKeys = Object.keys(oldSettings || {});
            const newKeys = Object.keys(newSettings || {});
            
            newKeys.forEach(key => {
                if (!(key in oldSettings)) {
                    changes.added.push(getLabel(key));
                } else if (oldSettings[key] !== newSettings[key]) {
                    // Store detailed change info with old and new values
                    changes.modified.push({ 
                        title: getLabel(key), 
                        fields: [],
                        oldValue: oldSettings[key],
                        newValue: newSettings[key],
                        key: key
                    });
                } else {
                    changes.unchanged++;
                }
            });
            
            oldKeys.forEach(key => {
                if (!(key in newSettings)) {
                    changes.removed.push(getLabel(key));
                }
            });
            
            return changes;
        }
        
        // Generate smart change message with value details
        function generateChangeMessage(changes, sheetName, lang) {
            const parts = [];
            const isTr = lang === 'tr';
            
            if (changes.added.length > 0) {
                if (changes.added.length <= 2) {
                    const names = changes.added.map(n => `"${n}"`).join(', ');
                    parts.push(isTr 
                        ? `<span style="color:#22c55e;">+${changes.added.length} yeni:</span> ${names}`
                        : `<span style="color:#22c55e;">+${changes.added.length} new:</span> ${names}`);
                } else {
                    parts.push(isTr 
                        ? `<span style="color:#22c55e;">+${changes.added.length} yeni eklendi</span>`
                        : `<span style="color:#22c55e;">+${changes.added.length} new added</span>`);
                }
            }
            
            if (changes.modified.length > 0) {
                // Check if this is a settings change with value tracking
                const hasValueTracking = changes.modified.some(m => m.oldValue !== undefined);
                
                if (hasValueTracking) {
                    // Show detailed value changes for settings
                    const details = changes.modified.slice(0, 3).map(m => {
                        const oldVal = truncateValue(m.oldValue);
                        const newVal = truncateValue(m.newValue);
                        return `<strong>${m.title}</strong>: ${oldVal} → ${newVal}`;
                    }).join('<br>');
                    parts.push(isTr 
                        ? `<span style="color:#f59e0b;">✏️ ${changes.modified.length} güncellendi:</span><br>${details}`
                        : `<span style="color:#f59e0b;">✏️ ${changes.modified.length} updated:</span><br>${details}`);
                    if (changes.modified.length > 3) {
                        parts.push(isTr ? `<em>...ve ${changes.modified.length - 3} daha</em>` : `<em>...and ${changes.modified.length - 3} more</em>`);
                    }
                } else if (changes.modified.length <= 2) {
                    const details = changes.modified.map(m => {
                        const fieldStr = m.fields && m.fields.length > 0 ? ` (${m.fields.join(', ')})` : '';
                        return `"${m.title}"${fieldStr}`;
                    }).join(', ');
                    parts.push(isTr 
                        ? `<span style="color:#f59e0b;">✏️ ${changes.modified.length} güncellendi:</span> ${details}`
                        : `<span style="color:#f59e0b;">✏️ ${changes.modified.length} updated:</span> ${details}`);
                } else {
                    parts.push(isTr 
                        ? `<span style="color:#f59e0b;">✏️ ${changes.modified.length} kayıt güncellendi</span>`
                        : `<span style="color:#f59e0b;">✏️ ${changes.modified.length} records updated</span>`);
                }
            }
            
            if (changes.removed.length > 0) {
                if (changes.removed.length <= 2) {
                    const names = changes.removed.map(n => `"${n}"`).join(', ');
                    parts.push(isTr 
                        ? `<span style="color:#ef4444;">-${changes.removed.length} silindi:</span> ${names}`
                        : `<span style="color:#ef4444;">-${changes.removed.length} removed:</span> ${names}`);
                } else {
                    parts.push(isTr 
                        ? `<span style="color:#ef4444;">-${changes.removed.length} silindi</span>`
                        : `<span style="color:#ef4444;">-${changes.removed.length} removed</span>`);
                }
            }
            
            if (parts.length === 0) {
                const total = changes.unchanged + changes.added.length + changes.modified.length;
                return isTr 
                    ? `<span style="color:#64748b;">✓ ${total} kayıt (değişiklik yok)</span>`
                    : `<span style="color:#64748b;">✓ ${total} records (no changes)</span>`;
            }
            
            return parts.join('<br>');
        }
        
        // Truncate long values for display
        function truncateValue(val) {
            if (val === undefined || val === null) return 'â€”';
            const str = String(val);
            if (str.length > 20) {
                return str.substring(0, 17) + '...';
            }
            return str;
        }
        
        // Get change type for styling
        function getChangeType(changes) {
            if (changes.added.length > 0 && changes.modified.length === 0 && changes.removed.length === 0) {
                return 'added';
            }
            if (changes.removed.length > 0 && changes.added.length === 0 && changes.modified.length === 0) {
                return 'removed';
            }
            if (changes.modified.length > 0 || (changes.added.length > 0 && changes.removed.length > 0)) {
                return 'modified';
            }
            if (changes.added.length === 0 && changes.removed.length === 0 && changes.modified.length === 0) {
                return 'unchanged';
            }
            return 'mixed';
        }
        
        // Render change log to sidebar
        function renderSidebarLog() {
            const container = document.getElementById('sidebarLogContent');
            if (!container) return;
            
            if (UPDATE_LOG.length === 0) {
                container.innerHTML = `<span class="text-muted">${lang === 'tr' ? 'Değişiklik yok' : 'No changes'}</span>`;
                return;
            }
            
            const icons = {
                'Settings': { icon: 'fa-cog', color: '#64748b' },
                'News': { icon: 'fa-newspaper', color: '#f59e0b' },
                'Events': { icon: 'fa-calendar', color: '#6366f1' },
                'Faculty': { icon: 'fa-user-tie', color: '#0f172a' },
                'Research': { icon: 'fa-flask', color: '#10b981' },
                'Publications': { icon: 'fa-book', color: '#8b5cf6' },
                'Courses': { icon: 'fa-graduation-cap', color: '#ec4899' },
                'Projects': { icon: 'fa-rocket', color: '#14b8a6' },
                'Labs': { icon: 'fa-microscope', color: '#3b82f6' },
                'Jobs': { icon: 'fa-briefcase', color: '#22c55e' },
                'Alumni': { icon: 'fa-users', color: '#f97316' },
                'Partners': { icon: 'fa-handshake', color: '#0ea5e9' },
                'Students': { icon: 'fa-user-graduate', color: '#a855f7' }
            };
            
            // Only show sheets with changes
            const changed = UPDATE_LOG.filter(item => item.changeType !== 'unchanged');
            
            if (changed.length === 0) {
                container.innerHTML = `
                    <div class="changelog-summary">
                        <i class="fa-solid fa-check-circle"></i>
                        ${lang === 'tr' ? 'Tüm veriler güncel' : 'All data up to date'}
                    </div>
                    <span class="text-muted">${lang === 'tr' ? 'Son yenilemede değişiklik tespit edilmedi.' : 'No changes detected in last refresh.'}</span>
                `;
                return;
            }
            
            // Count total changes
            let totalAdded = 0, totalModified = 0, totalRemoved = 0;
            changed.forEach(item => {
                if (item.changes) {
                    totalAdded += item.changes.added?.length || 0;
                    totalModified += item.changes.modified?.length || 0;
                    totalRemoved += item.changes.removed?.length || 0;
                }
            });
            
            // Build summary
            const summaryParts = [];
            if (totalAdded > 0) summaryParts.push(`+${totalAdded}`);
            if (totalModified > 0) summaryParts.push(`✏️${totalModified}`);
            if (totalRemoved > 0) summaryParts.push(`-${totalRemoved}`);
            
            let html = `
                <div class="changelog-summary has-changes">
                    <i class="fa-solid fa-sync-alt"></i>
                    ${lang === 'tr' ? `${changed.length} sekmede değişiklik` : `Changes in ${changed.length} tab(s)`}
                    ${summaryParts.length > 0 ? `(${summaryParts.join(', ')})` : ''}
                </div>
            `;
            
            html += changed.slice(0, 8).map(item => {
                const cfg = icons[item.name] || { icon: 'fa-database', color: '#64748b' };
                const displayName = lang === 'tr' ? (SHEET_NAMES_TR[item.name] || item.name) : item.name;
                
                return `
                    <div class="changelog-item">
                        <div class="changelog-icon" style="background:${cfg.color};">
                            <i class="fa-solid ${cfg.icon}"></i>
                        </div>
                        <div class="changelog-info">
                            <div class="changelog-name">${displayName}</div>
                            <div class="changelog-detail">${item.message}</div>
                        </div>
                    </div>
                `;
            }).join('');
            
            container.innerHTML = html;
            
            // Auto-expand the log panel when there are changes
            const logPanel = document.getElementById('sidebarChangeLog');
            if (logPanel && changed.length > 0) {
                logPanel.style.display = 'block';
            }
        }
        
        // Update sidebar last updated time
        function updateSidebarInfo() {
            const ts = localStorage.getItem('lastUpdatedTs');
            const el = document.getElementById('sidebarLastUpdated');
            if (el && ts) {
                const d = new Date(parseInt(ts));
                el.textContent = d.toLocaleTimeString(lang === 'tr' ? 'tr-TR' : 'en-US', { hour: '2-digit', minute: '2-digit' });
            }
        }
        
        function renderUpdateLog() {
            const container = document.getElementById('updateLogContent');
            if (!container) return;
            
            if (UPDATE_LOG.length === 0) {
                container.innerHTML = `<p class="text-muted"><span data-en>No updates yet</span><span data-tr>Henüz güncelleme yok</span></p>`;
                return;
            }
            
            const icons = {
                'Settings': { icon: 'fa-cog', color: '#64748b' },
                'News': { icon: 'fa-newspaper', color: '#f59e0b' },
                'Events': { icon: 'fa-calendar', color: '#6366f1' },
                'Faculty': { icon: 'fa-user-tie', color: '#0f172a' },
                'Research': { icon: 'fa-flask', color: '#10b981' },
                'Publications': { icon: 'fa-book', color: '#8b5cf6' },
                'Courses': { icon: 'fa-graduation-cap', color: '#ec4899' },
                'Projects': { icon: 'fa-rocket', color: '#14b8a6' },
                'Labs': { icon: 'fa-microscope', color: '#3b82f6' },
                'Jobs': { icon: 'fa-briefcase', color: '#22c55e' },
                'Alumni': { icon: 'fa-users', color: '#f97316' },
                'Partners': { icon: 'fa-handshake', color: '#0ea5e9' },
                'Students': { icon: 'fa-user-graduate', color: '#a855f7' }
            };
            
            const currentLang = localStorage.getItem('lang') || 'en';
            
            // Sort: changes first, then unchanged
            const sorted = [...UPDATE_LOG].sort((a, b) => {
                const aHasChanges = a.changeType !== 'unchanged';
                const bHasChanges = b.changeType !== 'unchanged';
                if (aHasChanges && !bHasChanges) return -1;
                if (!aHasChanges && bHasChanges) return 1;
                return 0;
            });
            
            const html = sorted.map(item => {
                const cfg = icons[item.name] || { icon: 'fa-database', color: '#64748b' };
                const displayName = currentLang === 'tr' ? (SHEET_NAMES_TR[item.name] || item.name) : item.name;
                
                // Change indicator styling
                let borderColor = '#e2e0dc';
                if (item.changeType === 'added') borderColor = '#22c55e';
                else if (item.changeType === 'removed') borderColor = '#ef4444';
                else if (item.changeType === 'modified' || item.changeType === 'mixed') borderColor = '#f59e0b';
                
                return `
                    <div class="update-log-item" style="border-left: 3px solid ${borderColor}; padding-left: 0.75rem;">
                        <div class="update-log-icon" style="background:${cfg.color};">
                            <i class="fa-solid ${cfg.icon}"></i>
                        </div>
                        <div class="update-log-info" style="flex:1;">
                            <div class="update-log-name">${displayName}</div>
                            <div class="update-log-count" style="font-size:0.8rem; line-height:1.4;">${item.message}</div>
                        </div>
                        <div class="update-log-time">${item.time}</div>
                    </div>
                `;
            }).join('');
            
            container.innerHTML = html;
            
            // Also update sidebar log
            renderSidebarLog();
            updateSidebarInfo();
        }

        let lang = localStorage.getItem('lang') || 'en';
        
        // Track current detail page for language switching
        let currentDetailPage = null;
        let currentDetailIndex = null;

        // cache-bust token so edits in Google Sheet reflect immediately
        let CACHE_BUST = Date.now();
        let IS_REFRESHING = false;

        // ═══════════════════════════════════════════════════════════════════════════
        // GOOGLE SHEETS FETCH
        // ═══════════════════════════════════════════════════════════════════════════
        function getSheetURL(tabName) {
            return `https://docs.google.com/spreadsheets/d/${GOOGLE_SHEET_ID}/gviz/tq?tqx=out:csv&sheet=${encodeURIComponent(tabName)}&headers=0&cb=${CACHE_BUST}`;
        }

        function parseCSV(csvText, returnRaw = false) {
            // First split into lines, handling multi-line quoted values
            const rows = [];
            let currentRow = [];
            let currentVal = '';
            let inQuotes = false;

            // Normalize line endings and fix common encoding issues
            let csv = csvText.replace(/\r\n/g, '\n').replace(/\r/g, '\n');
            // Fix double-encoded UTF-8
            csv = csv.replace(/Â·/g, '·').replace(/Â /g, ' ').replace(/Â/g, '');

            for (let i = 0; i < csv.length; i++) {
                const char = csv[i];
                const nextChar = csv[i + 1];

                if (char === '"') {
                    if (inQuotes && nextChar === '"') {
                        currentVal += '"';
                        i++;
                    } else {
                        inQuotes = !inQuotes;
                    }
                } else if (char === ',' && !inQuotes) {
                    currentRow.push(currentVal);
                    currentVal = '';
                } else if (char === '\n' && !inQuotes) {
                    currentRow.push(currentVal);
                    if (currentRow.length > 0) {
                        rows.push(currentRow);
                    }
                    currentRow = [];
                    currentVal = '';
                } else {
                    currentVal += char;
                }
            }

            // Add last row
            if (currentVal || currentRow.length) {
                currentRow.push(currentVal);
                if (currentRow.length > 0) rows.push(currentRow);
            }

            if (returnRaw) return rows;
            if (rows.length < 2) return [];

            // Clean headers - remove quotes, trim, lowercase
            const headers = rows[0].map(h => {
                let clean = (h || '').replace(/^["']|["']$/g, '').trim().toLowerCase().replace(/\s+/g, '_');
                return clean;
            });
            
            const data = [];

            for (let i = 1; i < rows.length; i++) {
                const values = rows[i];
                const row = {};
                headers.forEach((key, idx) => {
                    if (key) {
                        let val = values[idx] || '';
                        // Remove surrounding quotes from value
                        val = val.replace(/^["']|["']$/g, '').trim();
                        row[key] = val;
                    }
                });
                data.push(row);
            }
            return data;
        }

        async function fetchSheet(tabName) {
            try {
                const response = await fetch(getSheetURL(tabName), { cache: 'no-store' });
                if (!response.ok) throw new Error('Failed to fetch');
                const csv = await response.text();
                return parseCSV(csv, tabName === 'Settings'); // Use raw mode for Settings
            } catch (err) {
                console.error(`Error fetching ${tabName}:`, err);
                return [];
            }
        }

        async function fetchSettings() {
            try {
                const rows = await fetchSheet(SHEETS.settings);
                const settings = {};

                // Handle raw rows for Settings to robustly support multiline cells (Alt+Enter)
                // and missing headers/transposed layouts
                rows.forEach(row => {
                    if (!row || row.length < 2) return;

                    const keyCell = row[0];
                    const valCell = row[1];

                    // If cell contains newlines, split them (handling Alt+Enter in Sheets)
                    if (keyCell.includes('\n') || valCell.includes('\n')) {
                        const keys = keyCell.split('\n');
                        const vals = valCell.split('\n');
                        const count = Math.max(keys.length, vals.length);

                        for (let i = 0; i < count; i++) {
                            const k = (keys[i] || '').trim();
                            const v = (vals[i] || '').trim();
                            if (k && k.toLowerCase() !== 'key') { // skip header 'key'
                                settings[k] = v;
                            }
                        }
                    } else {
                        const k = keyCell.trim();
                        const v = valCell.trim();
                        if (k && k.toLowerCase() !== 'key') {
                            settings[k] = v;
                        }
                    }
                });
                
                // Extract and hash admin password if present in sheet
                if (settings.admin_password) {
                    ADMIN_CONFIG.sheetPasswordHash = await secureHash(settings.admin_password);
                    // Remove from settings object so it's not exposed
                    delete settings.admin_password;
                }
                
                return settings;
            } catch (err) {
                console.error('Error parsing settings:', err);
                return {};
            }
        }

        // ═══════════════════════════════════════════════════════════════════════════
        // RENDER FUNCTIONS
        // ═══════════════════════════════════════════════════════════════════════════

        function t(en, tr) {
            // Bilingual translation function
            // TR mode: prefer tr, fallback to en
            // EN mode: use en
            if (lang === 'tr') {
                return tr || en;
            }
            return en;
        }

        function getTagClass(category) {
            const map = {
                'grant': 'tag-accent', 'research': 'tag-accent',
                'award': 'tag-green', 'competition': 'tag-green',
                'academic': 'tag-purple', 'capstone': 'tag-purple',
                'industry': 'tag-cyan', 'event': 'tag-pink',
                'seminar': 'tag-accent', 'workshop': 'tag-purple',
                'deadline': 'tag-red', 'phd': 'tag-accent', 'msc': 'tag-green'
            };
            return map[(category || '').toLowerCase()];
        }

        function formatDate(dateStr) {
            if (!dateStr) return { day: '--', month: '---' };
            const d = new Date(dateStr);
            const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
            return { day: d.getDate(), month: months[d.getMonth()] };
        }

        function renderSettings() {
            const s = DATA.settings;
            document.getElementById('siteName').textContent = s.site_name || 'İSTUN Mechatronics Engineering';
            document.getElementById('heroTitle').textContent = t(s.hero_title_en, s.hero_title_tr) || 'Engineering Intelligent Systems';
            document.getElementById('heroSubtitle').textContent = t(s.hero_subtitle_en, s.hero_subtitle_tr);

            // Stats
            const stats = [
                { value: s.stat_faculty || '18', label: t('Faculty', 'Akademisyen') },
                { value: s.stat_students || '450', label: t('Students', 'Öğrenci') },
                { value: s.stat_publications || '127', label: t('Publications', 'Yayın') },
                { value: s.stat_grants || 'â‚º18M', label: t('Grants', 'Hibe') },
                { value: s.stat_employment || '94%', label: t('Employment', 'İstihdam') },
                { value: s.stat_partners || '32', label: t('Partners', 'Ortak') }
            ];

            document.getElementById('statsGrid').innerHTML = stats.map(st => `
            <div class="stat-card">
                <span class="stat-value">${st.value}</span>
                <div class="stat-label">${st.label}</div>
            </div>
        `).join('');
        }

        function renderNews() {
            const news = DATA.news.slice(0, 6);
            document.getElementById('newsBadge').textContent = DATA.news.length;
            
            // Update notification badge with upcoming events count
            const upcomingEventsCount = DATA.events.filter(e => {
                const eventDate = new Date(e.date);
                return eventDate >= new Date();
            }).length;
            const notifBadge = document.getElementById('notifBadge');
            notifBadge.textContent = upcomingEventsCount;
            notifBadge.setAttribute('data-count', upcomingEventsCount);

            const newsHTML = news.slice(0, 3).map((n, i) => {
                const d = formatDate(n.date);
                const color = n.category?.toLowerCase() === 'award' ? 'var(--green)' :
                    n.category?.toLowerCase() === 'academic' ? 'var(--purple)' : 'var(--amber)';
                return `
                <div class="news-card card-clickable" onclick="goToNewsDetail(${i})">
                    <div class="news-img" style="background-image:url('${n.image || 'https://images.unsplash.com/photo-1460925895917-afdab827c52f?w=600&q=80'}');">
                        <div class="news-date" style="background:${color};"><span class="day">${d.day}</span><span class="month">${d.month}</span></div>
                    </div>
                    <div class="news-body">
                        <span class="tag ${getTagClass(n.category)}">${n.category || 'News'}</span>
                        <h4>${t(n.title_en, n.title_tr) || 'News Item'}</h4>
                        <p>${t(n.description_en, n.description_tr)}</p>
                    </div>
                </div>
            `;
            }).join('');

            document.getElementById('latestNews').innerHTML = newsHTML || `<p>${t('No news available.', 'Haber bulunamadı.')}</p>`;
            document.getElementById('allNews').innerHTML = DATA.news.map((n, i) => {
                const d = formatDate(n.date);
                return `
                <div class="news-card card-clickable" onclick="goToNewsDetail(${i})">
                    <div class="news-img" style="background-image:url('${n.image || 'https://images.unsplash.com/photo-1460925895917-afdab827c52f?w=600&q=80'}');">
                        <div class="news-date"><span class="day">${d.day}</span><span class="month">${d.month}</span></div>
                    </div>
                    <div class="news-body">
                        <span class="tag ${getTagClass(n.category)}">${n.category || 'News'}</span>
                        <h4>${t(n.title_en, n.title_tr)}</h4>
                        <p>${t(n.description_en, n.description_tr)}</p>
                    </div>
                </div>
            `;
            }).join('') || `<p>${t('No news.', 'Haber yok.')}</p>`;
        }

        function renderEvents() {
            const events = DATA.events.slice(0, 4);

            const eventsHTML = events.map((e, i) => `
            <div class="timeline-item card-clickable" onclick="goToEventDetail(${i})" style="cursor:pointer;">
                <div class="timeline-date">${e.date} · ${e.time}</div>
                <div class="timeline-card">
                    <span class="tag ${getTagClass(e.type)}">${e.type || 'Event'}</span>
                    <h4>${t(e.title_en, e.title_tr)}</h4>
                    <p>${t(e.description_en, e.description_tr)}</p>
                </div>
            </div>
        `).join('');

            document.getElementById('upcomingEvents').innerHTML = eventsHTML || `<p>${t('No upcoming events.', 'Yaklaşan etkinlik yok.')}</p>`;
            document.getElementById('allEvents').innerHTML = eventsHTML || `<p>${t('No events.', 'Etkinlik yok.')}</p>`;

            // Next event card
            if (events[0]) {
                document.getElementById('nextEventText').innerHTML = `<strong>${events[0].date}</strong><br>${t(events[0].title_en, events[0].title_tr) || events[0].title}`;
            }
        }

        function renderResearch() {
            const colors = ['#10b981', '#6366f1', '#ec4899', '#14b8a6', '#f59e0b'];
            const icons = ['fa-robot', 'fa-microchip', 'fa-star', 'fa-hand', 'fa-bolt'];

            // Featured on home (max 3, randomized)
            const shuffled = [...DATA.research].sort(() => Math.random() - 0.5);
            const featured = shuffled.slice(0, 3);
            
            const featuredHTML = featured.map((r, i) => {
                const originalIdx = DATA.research.indexOf(r);
                return `
            <div class="card card-clickable" onclick="goToResearchDetail(${originalIdx})">
                <div class="card-img" style="background-image:url('${r.image || 'https://images.unsplash.com/photo-1485827404703-89b55fcc595e?w=600&q=80'}');">
                    <div class="card-img-overlay"></div>
                    <div class="card-img-badge"><span class="tag tag-green">${r.type || 'Lab'}</span></div>
                </div>
                <div class="card-body">
                    <h3>${t(r.name_en, r.name_tr)}</h3>
                    <p>${t(r.description_en, r.description_tr)}</p>
                </div>
                <div class="card-footer"><span>${r.lead}</span><span class="card-footer-link">${t('Learn more', 'Detaylar')} →</span></div>
            </div>
            `;
            }).join('');
            document.getElementById('featuredResearch').innerHTML = featuredHTML || `<p>${t('No research groups.', 'Araştırma grubu yok.')}</p>`;

            // Full list with clickable cards
            const fullHTML = DATA.research.map((r, i) => `
            <div class="research-card card-clickable" onclick="goToResearchDetail(${i})" style="cursor:pointer;">
                <div class="research-header">
                    <div class="research-icon" style="background:linear-gradient(135deg, ${colors[i % colors.length]}, ${colors[(i + 1) % colors.length]});"><i class="fa-solid ${icons[i % icons.length]}"></i></div>
                    <div class="research-info">
                        <h3>${t(r.name_en, r.name_tr)}</h3>
                        <p>${r.focus}</p>
                    </div>
                </div>
                <p class="research-desc">${t(r.description_en, r.description_tr)}</p>
                <div class="research-members">
                    <span class="research-member"><img src="https://ui-avatars.com/api/?name=${encodeURIComponent(r.lead || 'L')}&background=0f172a&color=fff&size=32" alt=""> ${r.lead} (Lead)</span>
                    ${r.members ? `<span class="research-member">+${r.members} members</span>` : ''}
                </div>
                <div style="margin-top:0.75rem;text-align:right;">
                    <span class="card-footer-link" style="color:var(--accent);font-size:0.85rem;">${t('View Details', 'Detaylar')} →</span>
                </div>
            </div>
        `).join('');
            document.getElementById('researchGroups').innerHTML = fullHTML || `<p>${t('No research groups.', 'Araştırma grubu yok.')}</p>`;
        }

        function goToResearchDetail(index) {
            currentDetailPage = 'research';
            currentDetailIndex = index;
            const r = DATA.research[index];
            if (!r) return;

            document.getElementById('researchDetailTitle').textContent = t(r.name_en, r.name_tr);
            document.getElementById('researchDetailFocus').textContent = r.focus || '';
            document.getElementById('researchDetailType').textContent = r.type || 'Research';
            document.getElementById('researchDetailLead').textContent = r.lead || '—';
            document.getElementById('researchDetailMembers').textContent = r.members ? `${r.members} ${t('members', 'üye')}` : '—';
            document.getElementById('researchDetailImage').style.backgroundImage = `url('${r.image || 'https://images.unsplash.com/photo-1485827404703-89b55fcc595e?w=600&q=80'}')`;
            
            // Content with proper line breaks
            const content = t(r.content_en, r.content_tr) || t(r.description_en, r.description_tr);
            document.getElementById('researchDetailContent').innerHTML = content ? content.replace(/\n/g, '<br>') : '';
            
            // Publications
            const pubBox = document.getElementById('researchPublicationsBox');
            if (r.publications) {
                pubBox.style.display = 'block';
                document.getElementById('researchDetailPublications').textContent = r.publications;
            } else {
                pubBox.style.display = 'none';
            }
            
            // Projects
            const projBox = document.getElementById('researchProjectsBox');
            if (r.projects) {
                projBox.style.display = 'block';
                document.getElementById('researchDetailProjects').textContent = r.projects;
            } else {
                projBox.style.display = 'none';
            }
            
            // Equipment
            const equipBox = document.getElementById('researchEquipmentBox');
            if (r.equipment) {
                equipBox.style.display = 'block';
                document.getElementById('researchDetailEquipment').textContent = r.equipment;
            } else {
                equipBox.style.display = 'none';
            }

            goTo('research-detail');
        }

        function renderFaculty() {
            const html = DATA.faculty.map(f => `
            <div class="faculty-card card-clickable" onclick="goToProfile('${(f.name || '').replace(/'/g, "\\'")}')">
                <img src="${f.photo || `https://ui-avatars.com/api/?name=${encodeURIComponent(f.name || 'F')}&background=6366f1&color=fff&size=120`}" class="faculty-avatar" alt="${f.name}">
                <h3 class="faculty-name">${f.name}</h3>
                <p class="faculty-title">${f.title}</p>
                <div class="faculty-field">${t(f.research_en, f.research_tr)}</div>
                <div class="faculty-links-spacer"></div>
                <div class="faculty-links">
                    ${f.email ? `<a href="mailto:${f.email}" title="Email" onclick="event.stopPropagation()"><i class="fa-solid fa-envelope"></i></a>` : ''}
                    ${f.yok_cv ? `<a href="${f.yok_cv}" target="_blank" title="${t('CoHE Academic CV', 'YÖK Akademik CV')}" onclick="event.stopPropagation()"><i class="fa-solid fa-graduation-cap"></i></a>` : ''}
                    ${f.scholar ? `<a href="${f.scholar}" target="_blank" title="Google Scholar" onclick="event.stopPropagation()"><i class="fa-brands fa-google-scholar"></i></a>` : ''}
                    ${f.github ? `<a href="${f.github}" target="_blank" title="GitHub" onclick="event.stopPropagation()"><i class="fa-brands fa-github"></i></a>` : ''}
                </div>
            </div>
        `).join('');
            document.getElementById('facultyGrid').innerHTML = html || `<p>${t('No faculty data.', 'Akademisyen verisi yok.')}</p>`;
        }

        let currentProfileName = null;
        
        function goToProfile(name) {
            currentProfileName = name;
            renderProfile(name);
            goTo('profile');
        }

        function renderProfile(name) {
            const f = DATA.faculty.find(item => item.name === name);
            if (!f) return;

            // Header info
            document.getElementById('profName').textContent = f.name;
            document.getElementById('profTitle').textContent = f.title;
            document.getElementById('profPhoto').src = f.photo || `https://ui-avatars.com/api/?name=${encodeURIComponent(f.name || 'F')}&background=6366f1&color=fff&size=400`;

            // Core Meta
            document.getElementById('profResearch').textContent = t(f.research_en, f.research_tr) || 'â€”';

            // Contextual Sections (Bio, Education, Office, Honors)
            const bio = t(f.bio_en, f.bio_tr);
            if (bio) {
                document.getElementById('profBioSection').style.display = 'block';
                document.getElementById('profBio').textContent = bio;
            } else {
                document.getElementById('profBioSection').style.display = 'none';
            }

            const edu = t(f.education_en, f.education_tr);
            if (edu) {
                document.getElementById('profEducationSection').style.display = 'block';
                document.getElementById('profEducation').textContent = edu;
            } else {
                document.getElementById('profEducationSection').style.display = 'none';
            }

            if (f.office) {
                document.getElementById('profOfficeSection').style.display = 'block';
                document.getElementById('profOffice').textContent = f.office;
            } else {
                document.getElementById('profOfficeSection').style.display = 'none';
            }

            const honors = t(f.honors_en, f.honors_tr);
            if (honors) {
                document.getElementById('profHonorsSection').style.display = 'block';
                document.getElementById('profHonors').textContent = honors;
            } else {
                document.getElementById('profHonorsSection').style.display = 'none';
            }

            // Links
            const linksHTML = [];
            if (f.email) linksHTML.push(`<a href="mailto:${f.email}" class="profile-contact-link"><i class="fa-solid fa-envelope"></i> <span>${f.email}</span></a>`);
            if (f.yok_cv) linksHTML.push(`<a href="${f.yok_cv}" target="_blank" class="profile-contact-link"><i class="fa-solid fa-graduation-cap"></i> <span>${t('CoHE Academic CV', 'YÖK Akademik CV')}</span></a>`);
            if (f.scholar) linksHTML.push(`<a href="${f.scholar}" target="_blank" class="profile-contact-link"><i class="fa-brands fa-google-scholar"></i> <span>Google Scholar</span></a>`);
            if (f.github) linksHTML.push(`<a href="${f.github}" target="_blank" class="profile-contact-link"><i class="fa-brands fa-github"></i> <span>GitHub</span></a>`);

            document.getElementById('profLinks').innerHTML = linksHTML.join('') || `<p class="text-muted">${t('No links available', 'Link bulunamadı')}</p>`;
            
            // ========== RELATED CONTENT ==========
            const facultyName = f.name || '';
            const facultyNameLower = facultyName.toLowerCase();
            
            // Helper to check if name matches
            const nameMatches = (str) => {
                if (!str) return false;
                const strLower = str.toLowerCase();
                // Match full name or last name
                const nameParts = facultyName.split(' ');
                const lastName = nameParts[nameParts.length - 1].toLowerCase();
                return strLower.includes(facultyNameLower) || strLower.includes(lastName);
            };
            
            // Publications by this faculty
            const relatedPubs = DATA.publications.filter(p => nameMatches(p.authors));
            if (relatedPubs.length > 0) {
                document.getElementById('profPublicationsSection').style.display = 'block';
                document.getElementById('profPublications').innerHTML = relatedPubs.slice(0, 5).map(p => `
                    <div class="profile-related-item">
                        <h4>${p.title}</h4>
                        <p>${p.journal}, ${p.year}${p.citations ? ` • ${p.citations} citations` : ''}</p>
                    </div>
                `).join('') + (relatedPubs.length > 5 ? `<p style="color:var(--text-muted);font-size:0.85rem;">+ ${relatedPubs.length - 5} ${t('more publications', 'daha fazla yayın')}</p>` : '');
            } else {
                document.getElementById('profPublicationsSection').style.display = 'none';
            }
            
            // Courses taught by this faculty
            const relatedCourses = DATA.courses.filter(c => nameMatches(c.instructor));
            if (relatedCourses.length > 0) {
                document.getElementById('profCoursesSection').style.display = 'block';
                document.getElementById('profCourses').innerHTML = relatedCourses.map(c => `
                    <div class="profile-related-item">
                        <span class="tag tag-accent">${c.code}</span>
                        <h4>${t(c.name_en, c.name_tr)}</h4>
                        <p>${c.ects} ECTS • ${t(c.description_en, c.description_tr) || ''}</p>
                    </div>
                `).join('');
            } else {
                document.getElementById('profCoursesSection').style.display = 'none';
            }
            
            // Research groups led by this faculty
            const relatedResearch = DATA.research.filter(r => nameMatches(r.lead));
            if (relatedResearch.length > 0) {
                document.getElementById('profResearchSection').style.display = 'block';
                document.getElementById('profResearchGroups').innerHTML = relatedResearch.map(r => `
                    <div class="profile-related-item card-clickable" onclick="goToResearchDetail(${DATA.research.indexOf(r)})" style="cursor:pointer;">
                        <span class="tag tag-green">${r.type || 'Research'}</span>
                        <h4>${t(r.name_en, r.name_tr)}</h4>
                        <p>${r.focus || t(r.description_en, r.description_tr)}</p>
                    </div>
                `).join('');
            } else {
                document.getElementById('profResearchSection').style.display = 'none';
            }
            
            // Students advised by this faculty
            const relatedStudents = DATA.students.filter(s => nameMatches(s.advisor));
            if (relatedStudents.length > 0) {
                document.getElementById('profStudentsSection').style.display = 'block';
                document.getElementById('profStudents').innerHTML = relatedStudents.map(s => `
                    <div class="profile-related-item">
                        <span class="tag ${s.program?.toLowerCase() === 'phd' ? 'tag-accent' : 'tag-green'}">${s.program}</span>
                        <h4>${s.name}</h4>
                        <p>${s.research || ''}</p>
                    </div>
                `).join('');
            } else {
                document.getElementById('profStudentsSection').style.display = 'none';
            }
            
            // Projects advised/led by this faculty
            const relatedProjects = DATA.projects.filter(p => nameMatches(p.advisor) || nameMatches(p.team));
            if (relatedProjects.length > 0) {
                document.getElementById('profProjectsSection').style.display = 'block';
                document.getElementById('profProjects').innerHTML = relatedProjects.slice(0, 5).map(p => `
                    <div class="profile-related-item card-clickable" onclick="goToProjectDetail(${DATA.projects.indexOf(p)})" style="cursor:pointer;">
                        <span class="tag ${getTagClass(p.category)}">${p.category || 'Project'}</span>
                        <h4>${t(p.title_en, p.title_tr)}</h4>
                        <p>${p.year} • ${t(p.description_en, p.description_tr)?.substring(0, 100) || ''}...</p>
                    </div>
                `).join('');
            } else {
                document.getElementById('profProjectsSection').style.display = 'none';
            }
        }

        function renderPublications() {
            const html = DATA.publications.map(p => `
            <div class="pub-item">
                <div class="pub-title">${p.title}</div>
                <div class="pub-authors">${p.authors}</div>
                <div class="pub-meta">
                    <span><i class="fa-solid fa-book"></i> ${p.journal}, ${p.year}</span>
                    ${p.citations ? `<span><i class="fa-solid fa-quote-left"></i> ${p.citations} citations</span>` : ''}
                    ${p.doi ? `<span><i class="fa-solid fa-link"></i> <a href="${p.doi}">DOI</a></span>` : ''}
                </div>
            </div>
        `).join('');
            document.getElementById('publicationsList').innerHTML = html || '<p>No publications.</p>';
        }

        function renderCourses() {
            const icons = { 'physics': 'fa-atom', 'programming': 'fa-code', 'robotics': 'fa-robot', 'control': 'fa-gears', 'ai': 'fa-brain', 'electronics': 'fa-microchip' };
            const colors = { 'physics': 'var(--purple)', 'programming': 'var(--green)', 'robotics': 'var(--pink)', 'control': 'var(--amber)', 'ai': 'var(--accent)', 'electronics': 'var(--cyan)' };

            const html = DATA.courses.map(c => {
                const cat = (c.category || 'physics').toLowerCase();
                return `
                <div class="course-item">
                    <div class="course-icon" style="background:${colors[cat] || 'var(--accent)'}20; color:${colors[cat] || 'var(--accent)'};">
                        <i class="fa-solid ${icons[cat] || 'fa-book'}"></i>
                    </div>
                    <div class="course-info">
                        <h4>${c.code}: ${t(c.name_en, c.name_tr)}</h4>
                        <p>${t(c.description_en, c.description_tr)} · ${c.instructor} · ${c.year}</p>
                    </div>
                    <span class="tag">${c.ects || '3'} ECTS</span>
                </div>
            `;
            }).join('');
            document.getElementById('coursesList').innerHTML = html || '<p>No courses.</p>';
        }

        function renderProjects() {
            const html = DATA.projects.map((p, i) => `
            <div class="project-card card-clickable" onclick="goToProjectDetail(${i})" style="cursor:pointer;">
                <div class="project-img" style="background-image:url('${p.image || 'https://images.unsplash.com/photo-1561557944-6e7860d1a7eb?w=600&q=80'}');">
                    <span class="project-year" ${p.award ? 'style="background:var(--amber);"' : ''}>${p.award ? '🏆 ' : ''}${p.year || '2024'}</span>
                </div>
                <div class="project-body">
                    <span class="tag ${getTagClass(p.category)}">${p.category || 'Capstone'}</span>
                    <h4>${t(p.title_en, p.title_tr)}</h4>
                    <p>${t(p.description_en, p.description_tr)}</p>
                    <div class="project-team">
                        <div class="project-avatars">
                            ${(p.team || 'Team').split(',').slice(0, 3).map(m => `<img src="https://ui-avatars.com/api/?name=${encodeURIComponent(m.trim())}&background=6366f1&color=fff&size=44" alt="">`).join('')}
                        </div>
                        <span class="project-names">${p.team}</span>
                    </div>
                </div>
            </div>
        `).join('');

            document.getElementById('projectsList').innerHTML = html || '<p>No projects.</p>';
            document.getElementById('featuredProjects').innerHTML = DATA.projects.slice(0, 4).map((p, i) => `
            <div class="project-card card-clickable" onclick="goToProjectDetail(${i})" style="cursor:pointer;">
                <div class="project-img" style="background-image:url('${p.image || 'https://images.unsplash.com/photo-1561557944-6e7860d1a7eb?w=600&q=80'}');">
                    <span class="project-year">${p.year || '2024'}</span>
                </div>
                <div class="project-body">
                    <span class="tag ${getTagClass(p.category)}">${p.category}</span>
                    <h4>${t(p.title_en, p.title_tr)}</h4>
                    <p>${t(p.description_en, p.description_tr)}</p>
                </div>
            </div>
        `).join('');
        }

        function renderLabs() {
            const html = DATA.labs.map((l, i) => `
            <div class="card card-clickable" onclick="goToLabDetail(${i})" style="cursor:pointer;">
                <div class="card-img" style="background-image:url('${l.image || 'https://images.unsplash.com/photo-1562654501-a0ccc0fc3fb1?w=600&q=80'}');"></div>
                <div class="card-body">
                    <span class="tag ${l.type === 'Research' ? 'tag-green' : ''}">${l.type || 'Lab'}</span>
                    <h3>${t(l.name_en, l.name_tr)}</h3>
                    <p>${t(l.equipment_en, l.equipment_tr)}</p>
                </div>
                <div class="card-footer">
                    <span>${l.room} · ${l.manager}</span>
                    <span class="card-footer-link">${t('View Details', 'Detaylar')} →</span>
                </div>
            </div>
        `).join('');
            document.getElementById('labsList').innerHTML = html || '<p>No labs.</p>';
        }

        function renderJobs() {
            document.getElementById('jobsBadge').textContent = DATA.jobs.length;

            const html = DATA.jobs.map((j, i) => `
            <div class="card-compact card-clickable" onclick="goToJobDetail(${i})" style="cursor:pointer;">
                <div class="card-compact-content">
                    <h4>${t(j.title_en, j.title_tr)}</h4>
                    <p>${cleanText(j.company)} · ${cleanText(j.location)} · ${cleanText(j.salary)}</p>
                </div>
                <span class="tag ${getTagClass(j.type)}">${j.type || 'Job'}</span>
            </div>
        `).join('');
            document.getElementById('jobsList').innerHTML = html || `<p>${t('No jobs available.', 'İş ilanı bulunamadı.')}</p>`;
        }

        function renderAlumni() {
            const s = DATA.settings;
            document.getElementById('alumniStats').innerHTML = `
            <div class="stat-card"><span class="stat-value">${s.alumni_total || '320'}</span><div class="stat-label">${t('Total Alumni', 'Toplam Mezun')}</div></div>
            <div class="stat-card"><span class="stat-value">${s.alumni_employed || '94%'}</span><div class="stat-label">${t('Employed', 'İstihdam')}</div></div>
            <div class="stat-card"><span class="stat-value">${s.alumni_startups || '8'}</span><div class="stat-label">${t('Startups', 'Girişim')}</div></div>
        `;

            const html = DATA.alumni.map(a => {
                const yearDisplay = a.year ? ` (${a.year})` : '';
                return `
            <div class="card-compact">
                <img src="${a.photo || `https://ui-avatars.com/api/?name=${encodeURIComponent(a.name || 'A')}&background=6366f1&color=fff&size=80`}" style="width:44px;height:44px;border-radius:50%;" alt="">
                <div class="card-compact-content">
                    <h4>${a.name || ''}${yearDisplay}</h4>
                    <p>${a.position || ''} @ ${a.company || ''}</p>
                </div>
            </div>
            `;
            }).join('');
            document.getElementById('alumniList').innerHTML = html || `<p>${t('No alumni data.', 'Mezun verisi yok.')}</p>`;
        }

        function renderStudents() {
            const html = DATA.students.map(s => `
            <tr>
                <td><strong>${s.name}</strong></td>
                <td><span class="tag ${s.program?.toLowerCase() === 'phd' ? 'tag-accent' : 'tag-green'}">${s.program}</span></td>
                <td>${s.advisor}</td>
                <td>${s.research}</td>
                <td>${s.year}</td>
            </tr>
        `).join('');
            document.getElementById('studentsBody').innerHTML = html || `<tr><td colspan="5">${t('No students.', 'Öğrenci yok.')}</td></tr>`;
        }

        function renderPartners() {
            const industry = DATA.partners.filter(p => p.type?.toLowerCase() === 'industry');
            const academic = DATA.partners.filter(p => p.type?.toLowerCase() === 'academic');

            const industryHTML = industry.map(p =>
                p.logo ? `<img src="${p.logo}" class="partner-logo" alt="${p.name}" title="${p.name}" style="height:${p.height || '24'}px;">` :
                    `<span style="color:var(--text-muted);font-weight:600;">${p.name}</span>`
            ).join('');

            document.getElementById('industryPartners').innerHTML = industryHTML || `<p>${t('No partners.', 'Ortak yok.')}</p>`;
            document.getElementById('homePartners').innerHTML = industryHTML;

            const academicHTML = academic.map(p => `
            <div class="card-compact">
                <div class="card-compact-icon" style="background:var(--accent-light); color:var(--accent);"><i class="fa-solid fa-university"></i></div>
                <div class="card-compact-content">
                    <h4>${p.name}</h4>
                    <p>${t(p.description_en, p.description_tr)}</p>
                </div>
            </div>
        `).join('');
            document.getElementById('academicPartners').innerHTML = academicHTML || `<p>${t('No academic partners.', 'Akademik ortak yok.')}</p>`;
        }

        function renderContact() {
            const s = DATA.settings;
            document.getElementById('contactContent').innerHTML = `
            <div>
                <h2>${t('Department Office', 'Bölüm Sekreterliği')}</h2>
                <p><i class="fa-solid fa-location-dot" style="width:18px; color:var(--accent);"></i> ${t('ISTUN Sütlüce Campus, Beyoğlu, İstanbul', 'İSTÜN Sütlüce Kampüsü, Beyoğlu, İstanbul')}</p>
                <p><i class="fa-solid fa-phone" style="width:18px; color:var(--accent);"></i> ${s.phone}</p>
                <p><i class="fa-solid fa-envelope" style="width:18px; color:var(--accent);"></i> ${s.email}</p>
                <p><i class="fa-solid fa-clock" style="width:18px; color:var(--accent);"></i> ${s.hours || 'Mon-Fri 09:00-17:00'}</p>
                
                <h2 style="margin-top:1.5rem;">${t('Key Contacts', 'Önemli Kişiler')}</h2>
                <p><strong>${t('Department Chair', 'Bölüm Başkanı')}:</strong> ${s.chair}</p>
                <p><strong>${t('Graduate Coordinator', 'Lisansüstü Koordinatörü')}:</strong> ${s.grad_coordinator}</p>
            </div>
            <div style="border-radius:var(--radius-lg); overflow:hidden; border:1px solid var(--border); height:300px;">
                <iframe 
                    width="100%" 
                    height="100%" 
                    style="border:0" 
                    loading="lazy" 
                    allowfullscreen 
                    referrerpolicy="no-referrer-when-downgrade"
                    src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3008.5827157498347!2d28.948493112251263!3d41.05625357122427!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x14cabba389541ebd%3A0x77aa0f2806492df6!2zxLBzdGFuYnVsIFNhxJ9swLFrIHZlIFRla25vbG9qaSDDnG5pdmVyc2l0ZXNp!5e0!3m2!1str!2str!4v1767903088679!5m2!1str!2str">
                </iframe>
            </div>
               `;
        }

        function renderAbout() {
            const s = DATA.settings;
            document.getElementById('aboutSubtitle').textContent = t(s.about_subtitle_en, s.about_subtitle_tr);
            document.getElementById('aboutContent').innerHTML = `
            <div>
                <h2>${t('Our Mission', 'Misyonumuz')}</h2>
                <p>${t(s.mission_en, s.mission_tr)}</p>
                <h2>${t('Vision', 'Vizyon')}</h2>
                <p>${t(s.vision_en, s.vision_tr)}</p>
            </div>
            <div>
                <h2>${t('Accreditation', 'Akreditasyon')}</h2>
                <p>${t(s.accreditation_en, s.accreditation_tr)}</p>
                <div class="alert alert-success"><i class="fa-solid fa-certificate"></i> ${s.accreditation_status || 'MÜDEK'}</div>
            </div>
        `;
        }

        // ═══════════════════════════════════════════════════════════════════════════
        // DETAIL PAGE RENDER FUNCTIONS
        // ═══════════════════════════════════════════════════════════════════════════
        
        function goToNewsDetail(index) {
            const n = DATA.news[index];
            if (!n) return;
            currentDetailPage = 'news';
            currentDetailIndex = index;
            document.getElementById('newsDetailCategory').textContent = n.category || 'News';
            document.getElementById('newsDetailCategory').className = 'tag ' + getTagClass(n.category);
            document.getElementById('newsDetailTitle').textContent = t(n.title_en, n.title_tr);
            document.getElementById('newsDetailDate').textContent = n.date;
            document.getElementById('newsDetailAuthor').textContent = n.author || 'Department';
            document.getElementById('newsDetailImage').style.backgroundImage = `url('${n.image || 'https://images.unsplash.com/photo-1460925895917-afdab827c52f?w=600&q=80'}')`;
            document.getElementById('newsDetailContent').textContent = t(n.content_en, n.content_tr) || t(n.description_en, n.description_tr);
            goTo('news-detail');
        }
        
        function goToEventDetail(index) {
            const e = DATA.events[index];
            if (!e) return;
            currentDetailPage = 'event';
            currentDetailIndex = index;
            document.getElementById('eventDetailType').textContent = e.type || 'Event';
            document.getElementById('eventDetailType').className = 'tag ' + getTagClass(e.type);
            document.getElementById('eventDetailTitle').textContent = t(e.title_en, e.title_tr);
            document.getElementById('eventDetailDate').textContent = e.date;
            document.getElementById('eventDetailTime').textContent = e.time;
            document.getElementById('eventDetailLocation').textContent = e.location;
            document.getElementById('eventDetailContent').textContent = t(e.content_en, e.content_tr) || t(e.description_en, e.description_tr);
            
            if (e.speaker) {
                document.getElementById('eventDetailSpeakerBox').style.display = 'flex';
                document.getElementById('eventDetailSpeaker').textContent = e.speaker;
            } else {
                document.getElementById('eventDetailSpeakerBox').style.display = 'none';
            }
            
            if (e.registration_link) {
                document.getElementById('eventRegisterBox').style.display = 'block';
                document.getElementById('eventRegisterLink').href = e.registration_link;
            } else {
                document.getElementById('eventRegisterBox').style.display = 'none';
            }
            goTo('event-detail');
        }
        
        function goToProjectDetail(index) {
            const p = DATA.projects[index];
            if (!p) return;
            currentDetailPage = 'project';
            currentDetailIndex = index;
            document.getElementById('projectDetailCategory').textContent = p.category || 'Project';
            document.getElementById('projectDetailCategory').className = 'tag ' + getTagClass(p.category);
            document.getElementById('projectDetailYear').textContent = p.year;
            document.getElementById('projectDetailTitle').textContent = t(p.title_en, p.title_tr);
            document.getElementById('projectDetailTeam').textContent = p.team;
            document.getElementById('projectDetailAdvisor').textContent = p.advisor;
            document.getElementById('projectDetailImage').style.backgroundImage = `url('${p.image || 'https://images.unsplash.com/photo-1581092160562-40aa08e78837?w=600&q=80'}')`;
            document.getElementById('projectDetailContent').textContent = t(p.content_en, p.content_tr) || t(p.description_en, p.description_tr);
            
            if (p.award) {
                document.getElementById('projectDetailAward').style.display = 'inline-flex';
                document.getElementById('projectAwardText').textContent = p.award;
            } else {
                document.getElementById('projectDetailAward').style.display = 'none';
            }
            
            if (p.technologies) {
                document.getElementById('projectDetailTech').innerHTML = p.technologies.split(',').map(tech => 
                    `<span class="tag tag-sm">${tech.trim()}</span>`
                ).join('');
            } else {
                document.getElementById('projectDetailTech').innerHTML = '';
            }
            
            if (p.github) {
                document.getElementById('projectGithubBox').style.display = 'block';
                document.getElementById('projectGithubLink').href = p.github;
            } else {
                document.getElementById('projectGithubBox').style.display = 'none';
            }
            goTo('project-detail');
        }
        
        function goToLabDetail(index) {
            const l = DATA.labs[index];
            if (!l) return;
            currentDetailPage = 'lab';
            currentDetailIndex = index;
            document.getElementById('labDetailType').textContent = l.type || 'Lab';
            document.getElementById('labDetailType').className = 'tag ' + getTagClass(l.type);
            document.getElementById('labDetailTitle').textContent = t(l.name_en, l.name_tr);
            document.getElementById('labDetailRoom').textContent = l.room;
            document.getElementById('labDetailManager').textContent = l.manager;
            document.getElementById('labDetailImage').style.backgroundImage = `url('${l.image || 'https://images.unsplash.com/photo-1581092160562-40aa08e78837?w=600&q=80'}')`;
            document.getElementById('labDetailContent').textContent = t(l.content_en, l.content_tr);
            document.getElementById('labDetailEquipment').textContent = t(l.equipment_en, l.equipment_tr);
            goTo('lab-detail');
        }
        
        function goToJobDetail(index) {
            const j = DATA.jobs[index];
            if (!j) return;
            currentDetailPage = 'job';
            currentDetailIndex = index;
            document.getElementById('jobDetailType').textContent = j.type || 'Full-Time';
            document.getElementById('jobDetailType').className = 'tag ' + getTagClass(j.type);
            document.getElementById('jobDetailTitle').textContent = t(j.title_en, j.title_tr);
            document.getElementById('jobDetailCompany').textContent = j.company;
            document.getElementById('jobDetailLocation').textContent = j.location;
            document.getElementById('jobDetailContent').textContent = t(j.content_en, j.content_tr) || t(j.description_en, j.description_tr);
            
            if (j.salary) {
                document.getElementById('jobSalaryItem').style.display = 'flex';
                document.getElementById('jobDetailSalary').textContent = j.salary;
            } else {
                document.getElementById('jobSalaryItem').style.display = 'none';
            }
            
            if (j.deadline) {
                document.getElementById('jobDeadlineItem').style.display = 'flex';
                document.getElementById('jobDetailDeadline').textContent = j.deadline;
            } else {
                document.getElementById('jobDeadlineItem').style.display = 'none';
            }
            
            if (j.apply_link) {
                document.getElementById('jobApplyBox').style.display = 'block';
                document.getElementById('jobApplyLink').href = j.apply_link;
            } else {
                document.getElementById('jobApplyBox').style.display = 'none';
            }
            goTo('job-detail');
        }
        
        // Refresh current detail page when language changes
        function refreshCurrentDetailPage() {
            // Refresh profile page if open
            if (currentProfileName) {
                renderProfile(currentProfileName);
            }
            
            if (currentDetailPage === null || currentDetailIndex === null) return;
            
            switch(currentDetailPage) {
                case 'news': goToNewsDetail(currentDetailIndex); break;
                case 'event': goToEventDetail(currentDetailIndex); break;
                case 'project': goToProjectDetail(currentDetailIndex); break;
                case 'lab': goToLabDetail(currentDetailIndex); break;
                case 'job': goToJobDetail(currentDetailIndex); break;
                case 'research': goToResearchDetail(currentDetailIndex); break;
            }
        }
        
        // Helper to fix double-encoded UTF-8 from Google Sheets
        function cleanText(str) {
            if (!str) return '';
            return str.replace(/Â·/g, '·').replace(/Â /g, ' ').replace(/Â/g, '');
        }

        function renderAll() {
            renderSettings();
            renderNews();
            renderEvents();
            renderResearch();
            renderFaculty();
            renderPublications();
            renderCourses();
            renderProjects();
            renderLabs();
            renderJobs();
            renderAlumni();
            renderStudents();
            renderPartners();
            renderContact();
            renderAbout();
        }

        // ═══════════════════════════════════════════════════════════════════════════
        // NAVIGATION
        // ═══════════════════════════════════════════════════════════════════════════

        function goTo(pageId, navEl) {
            // Clear detail tracking when navigating to a non-detail page
            if (!pageId.includes('-detail')) {
                currentDetailPage = null;
                currentDetailIndex = null;
            }
            // Clear profile tracking when navigating away from profile
            if (pageId !== 'profile') {
                currentProfileName = null;
            }
            
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
            if (navEl) navEl.classList.add('active');
            else {
                const nav = document.querySelector(`.nav-item[data-page="${pageId}"]`);
                if (nav) nav.classList.add('active');
            }
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            const page = document.getElementById(pageId);
            if (page) {
                page.classList.add('active');
                document.getElementById('mainContent').scrollTop = 0;
            }
            closeSidebar();
        }

        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('open');
            document.querySelector('.sidebar-overlay').classList.toggle('show');
        }
        function closeSidebar() {
            document.getElementById('sidebar').classList.remove('open');
            document.querySelector('.sidebar-overlay').classList.remove('show');
        }

        // ═══════════════════════════════════════════════════════════════════════════
        // SEARCH FUNCTIONALITY
        // ═══════════════════════════════════════════════════════════════════════════
        
        let searchTimeout = null;
        
        function performSearch(query) {
            clearTimeout(searchTimeout);
            const resultsContainer = document.getElementById('searchResults');
            
            if (!query || query.length < 2) {
                resultsContainer.innerHTML = '';
                resultsContainer.classList.remove('show');
                return;
            }
            
            searchTimeout = setTimeout(() => {
                const results = searchAllData(query.toLowerCase());
                displaySearchResults(results, query);
            }, 150);
        }
        
        function searchAllData(query) {
            const results = [];
            
            // Search News
            DATA.news.forEach((item, index) => {
                const title = t(item.title_en, item.title_tr) || '';
                const desc = t(item.description_en, item.description_tr) || '';
                if (title.toLowerCase().includes(query) || desc.toLowerCase().includes(query)) {
                    results.push({
                        type: 'news',
                        title: title,
                        meta: item.date,
                        icon: 'fa-newspaper',
                        color: '#ef4444',
                        action: () => goToNewsDetail(index)
                    });
                }
            });
            
            // Search Events
            DATA.events.forEach((item, index) => {
                const title = t(item.title_en, item.title_tr) || '';
                const desc = t(item.description_en, item.description_tr) || '';
                if (title.toLowerCase().includes(query) || desc.toLowerCase().includes(query)) {
                    results.push({
                        type: 'events',
                        title: title,
                        meta: item.date,
                        icon: 'fa-calendar',
                        color: '#8b5cf6',
                        action: () => goToEventDetail(index)
                    });
                }
            });
            
            // Search Faculty
            DATA.faculty.forEach((item, index) => {
                const name = item.name || '';
                const research = t(item.research_en, item.research_tr) || '';
                if (name.toLowerCase().includes(query) || research.toLowerCase().includes(query)) {
                    results.push({
                        type: 'faculty',
                        title: name,
                        meta: research,
                        icon: 'fa-user-tie',
                        color: '#6366f1',
                        action: () => { goTo('faculty'); setTimeout(() => showProfile(index), 100); }
                    });
                }
            });
            
            // Search Research
            DATA.research.forEach((item, index) => {
                const name = t(item.name_en, item.name_tr) || '';
                const desc = t(item.description_en, item.description_tr) || '';
                if (name.toLowerCase().includes(query) || desc.toLowerCase().includes(query)) {
                    results.push({
                        type: 'research',
                        title: name,
                        meta: item.lead,
                        icon: 'fa-flask',
                        color: '#10b981',
                        action: () => goTo('research')
                    });
                }
            });
            
            // Search Courses
            DATA.courses.forEach((item, index) => {
                const name = t(item.name_en, item.name_tr) || '';
                const code = item.code || '';
                if (name.toLowerCase().includes(query) || code.toLowerCase().includes(query)) {
                    results.push({
                        type: 'courses',
                        title: `${code}: ${name}`,
                        meta: item.instructor,
                        icon: 'fa-book',
                        color: '#f59e0b',
                        action: () => goTo('courses')
                    });
                }
            });
            
            // Search Projects
            DATA.projects.forEach((item, index) => {
                const title = t(item.title_en, item.title_tr) || '';
                const desc = t(item.description_en, item.description_tr) || '';
                if (title.toLowerCase().includes(query) || desc.toLowerCase().includes(query)) {
                    results.push({
                        type: 'projects',
                        title: title,
                        meta: item.team,
                        icon: 'fa-diagram-project',
                        color: '#ec4899',
                        action: () => goToProjectDetail(index)
                    });
                }
            });
            
            // Search Labs
            DATA.labs.forEach((item, index) => {
                const name = t(item.name_en, item.name_tr) || '';
                const equipment = t(item.equipment_en, item.equipment_tr) || '';
                if (name.toLowerCase().includes(query) || equipment.toLowerCase().includes(query)) {
                    results.push({
                        type: 'labs',
                        title: name,
                        meta: item.room,
                        icon: 'fa-microscope',
                        color: '#06b6d4',
                        action: () => goToLabDetail(index)
                    });
                }
            });
            
            // Search Jobs
            DATA.jobs.forEach((item, index) => {
                const title = t(item.title_en, item.title_tr) || '';
                const company = item.company || '';
                if (title.toLowerCase().includes(query) || company.toLowerCase().includes(query)) {
                    results.push({
                        type: 'jobs',
                        title: title,
                        meta: company,
                        icon: 'fa-briefcase',
                        color: '#14b8a6',
                        action: () => goToJobDetail(index)
                    });
                }
            });
            
            // Search Publications
            DATA.publications.forEach((item, index) => {
                const title = item.title || '';
                const authors = item.authors || '';
                if (title.toLowerCase().includes(query) || authors.toLowerCase().includes(query)) {
                    results.push({
                        type: 'publications',
                        title: title,
                        meta: authors,
                        icon: 'fa-file-lines',
                        color: '#6366f1',
                        action: () => goTo('publications')
                    });
                }
            });
            
            return results;
        }
        
        function displaySearchResults(results, query) {
            const container = document.getElementById('searchResults');
            
            if (results.length === 0) {
                container.innerHTML = `<div class="search-no-results">
                    <i class="fa-solid fa-search" style="font-size:1.5rem;margin-bottom:8px;opacity:0.3;"></i>
                    <p>${lang === 'tr' ? 'Sonuç bulunamadı' : 'No results found'}</p>
                </div>`;
                container.classList.add('show');
                return;
            }
            
            // Group results by type
            const grouped = {};
            results.forEach(r => {
                if (!grouped[r.type]) grouped[r.type] = [];
                grouped[r.type].push(r);
            });
            
            const typeNames = {
                news: lang === 'tr' ? 'Haberler' : 'News',
                events: lang === 'tr' ? 'Etkinlikler' : 'Events',
                faculty: lang === 'tr' ? 'Akademisyenler' : 'Faculty',
                research: lang === 'tr' ? 'Araştırma' : 'Research',
                courses: lang === 'tr' ? 'Dersler' : 'Courses',
                projects: lang === 'tr' ? 'Projeler' : 'Projects',
                labs: lang === 'tr' ? 'Laboratuvarlar' : 'Labs',
                jobs: lang === 'tr' ? 'İş İlanları' : 'Jobs',
                publications: lang === 'tr' ? 'Yayınlar' : 'Publications'
            };
            
            let html = '';
            for (const [type, items] of Object.entries(grouped)) {
                html += `<div class="search-category">${typeNames[type] || type}</div>`;
                items.slice(0, 3).forEach((item, idx) => {
                    html += `
                        <div class="search-result-item" onclick="searchResultClick(${results.indexOf(item)})">
                            <div class="search-result-icon" style="background:${item.color}20;color:${item.color};">
                                <i class="fa-solid ${item.icon}"></i>
                            </div>
                            <div class="search-result-content">
                                <div class="search-result-title">${highlightMatch(item.title, query)}</div>
                                <div class="search-result-meta">${item.meta || ''}</div>
                            </div>
                        </div>
                    `;
                });
            }
            
            container.innerHTML = html;
            container.classList.add('show');
            
            // Store results for click handling
            window._searchResults = results;
        }
        
        function highlightMatch(text, query) {
            if (!text) return '';
            // Escape special regex characters to prevent errors
            const escapedQuery = query.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
            const regex = new RegExp(`(${escapedQuery})`, 'gi');
            return text.replace(regex, '<mark style="background:#fef08a;padding:0 2px;border-radius:2px;">$1</mark>');
        }
        
        function searchResultClick(index) {
            const result = window._searchResults[index];
            if (result && result.action) {
                result.action();
                document.getElementById('searchInput').value = '';
                document.getElementById('searchResults').classList.remove('show');
            }
        }
        
        function showSearchResults() {
            const input = document.getElementById('searchInput');
            if (input.value.length >= 2) {
                document.getElementById('searchResults').classList.add('show');
            }
        }
        
        function hideSearchResultsDelayed() {
            setTimeout(() => {
                document.getElementById('searchResults').classList.remove('show');
            }, 200);
        }

        function setLang(l) {
            lang = l;
            document.documentElement.lang = l;
            document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.toggle('active', btn.textContent === l.toUpperCase()));
            localStorage.setItem('lang', l);
            renderAll();
            refreshCurrentDetailPage(); // Re-render detail page if one is open
            updateLastUpdatedLabel(); // keep the timestamp locale consistent
        }

        // ═══════════════════════════════════════════════════════════════════════════
        // REFRESH BAR UI
        // ═══════════════════════════════════════════════════════════════════════════

        function setRefreshUI(state, msgKey) {
            const btn = document.getElementById('sidebarRefreshBtn');
            const dot = document.getElementById('dataStatusDot');

            if (state === 'busy') {
                if (btn) {
                    btn.disabled = true;
                    btn.innerHTML = `<i class="fa-solid fa-spinner" style="animation: spin 1s linear infinite;"></i> <span data-en>...</span><span data-tr>...</span>`;
                }
                if (dot) {
                    dot.classList.add('loading');
                    dot.classList.remove('has-changes');
                }
            } else {
                if (btn) {
                    btn.disabled = false;
                    btn.innerHTML = `<i class="fa-solid fa-rotate"></i> <span data-en>Refresh</span><span data-tr>Yenile</span>`;
                }
                if (dot) {
                    dot.classList.remove('loading');
                }
            }
        }
        
        // Update status dot to reflect whether there were changes
        function updateChangeStatusIndicator() {
            const dot = document.getElementById('dataStatusDot');
            if (!dot) return;
            
            const hasChanges = UPDATE_LOG.some(item => item.changeType !== 'unchanged');
            
            if (hasChanges) {
                dot.classList.add('has-changes');
            } else {
                dot.classList.remove('has-changes');
            }
        }

        function updateLastUpdatedLabel() {
            // Update sidebar timestamp
            updateSidebarInfo();
        }

        // ═══════════════════════════════════════════════════════════════════════════
        // DATA LOADING (INITIAL + REFRESH)
        // ═══════════════════════════════════════════════════════════════════════════

        async function loadAllData() {
            // Clear previous log
            UPDATE_LOG.length = 0;
            
            const now = new Date();
            const timeStr = now.toLocaleTimeString('tr-TR');
            const currentLang = localStorage.getItem('lang') || 'en';
            
            // Fetch all data
            [
                DATA.settings,
                DATA.news,
                DATA.events,
                DATA.faculty,
                DATA.research,
                DATA.publications,
                DATA.courses,
                DATA.projects,
                DATA.labs,
                DATA.jobs,
                DATA.alumni,
                DATA.partners,
                DATA.students
            ] = await Promise.all([
                fetchSettings(),
                fetchSheet(SHEETS.news),
                fetchSheet(SHEETS.events),
                fetchSheet(SHEETS.faculty),
                fetchSheet(SHEETS.research),
                fetchSheet(SHEETS.publications),
                fetchSheet(SHEETS.courses),
                fetchSheet(SHEETS.projects),
                fetchSheet(SHEETS.labs),
                fetchSheet(SHEETS.jobs),
                fetchSheet(SHEETS.alumni),
                fetchSheet(SHEETS.partners),
                fetchSheet(SHEETS.students)
            ]);

            // Smart change detection for each sheet
            const sheets = [
                { name: 'Settings', data: DATA.settings, isSettings: true },
                { name: 'News', data: DATA.news },
                { name: 'Events', data: DATA.events },
                { name: 'Faculty', data: DATA.faculty },
                { name: 'Research', data: DATA.research },
                { name: 'Publications', data: DATA.publications },
                { name: 'Courses', data: DATA.courses },
                { name: 'Projects', data: DATA.projects },
                { name: 'Labs', data: DATA.labs },
                { name: 'Jobs', data: DATA.jobs },
                { name: 'Alumni', data: DATA.alumni },
                { name: 'Partners', data: DATA.partners },
                { name: 'Students', data: DATA.students }
            ];
            
            // Create new snapshot for saving
            const newSnapshot = {};
            
            for (const sheet of sheets) {
                const oldData = PREVIOUS_DATA[sheet.name];
                const newData = sheet.data;
                
                // Skip empty sheets
                if (!newData || (Array.isArray(newData) && newData.length === 0) || 
                    (!Array.isArray(newData) && Object.keys(newData).length === 0)) {
                    continue;
                }
                
                // Compare data
                let changes;
                if (sheet.isSettings) {
                    changes = compareSettings(oldData, newData, currentLang);
                } else {
                    changes = compareData(oldData, newData, sheet.name, currentLang);
                }
                
                // Generate message
                const message = generateChangeMessage(changes, sheet.name, currentLang);
                const changeType = getChangeType(changes);
                
                UPDATE_LOG.push({
                    name: sheet.name,
                    changeType: changeType,
                    message: message,
                    time: timeStr,
                    changes: changes
                });
                
                // Save to new snapshot
                newSnapshot[sheet.name] = Array.isArray(newData) ? [...newData] : {...newData};
            }
            
            // Save current data for next comparison
            PREVIOUS_DATA = newSnapshot;
            try {
                localStorage.setItem('previousDataSnapshot', JSON.stringify(newSnapshot));
            } catch (e) {
                // localStorage might be full, try to save just the essential data
                console.warn('Could not save full snapshot to localStorage:', e);
            }
            
            renderUpdateLog();
            renderSidebarLog();
            renderAll();
            
            // Update the status indicator to show if there were changes
            updateChangeStatusIndicator();

            // store last updated timestamp
            localStorage.setItem('lastUpdatedTs', String(Date.now()));
            updateLastUpdatedLabel();
        }

        async function refreshData() {
            if (IS_REFRESHING) return;
            IS_REFRESHING = true;

            CACHE_BUST = Date.now();
            setRefreshUI('busy', 'updating');

            try {
                await loadAllData();
                setRefreshUI('idle', 'updated');
                setTimeout(() => setRefreshUI('idle', 'ready'), 1500);
            } catch (e) {
                console.error(e);
                setRefreshUI('idle', 'error');
            } finally {
                IS_REFRESHING = false;
            }
        }

        // ═══════════════════════════════════════════════════════════════════════════
        // INIT
        // ═══════════════════════════════════════════════════════════════════════════

        async function init() {
            document.documentElement.lang = lang;
            document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.toggle('active', btn.textContent === lang.toUpperCase()));

            updateLastUpdatedLabel();
            setRefreshUI('idle', 'ready');

            // Check if sheet ID is configured
            if (GOOGLE_SHEET_ID === 'YOUR_GOOGLE_SHEET_ID_HERE') {
                document.getElementById('heroTitle').textContent = 'âš ï¸ Google Sheet Not Configured';
                document.getElementById('heroSubtitle').innerHTML = 'Please set your GOOGLE_SHEET_ID in the script section. <a href="#setup">See setup instructions below.</a>';
                return;
            }

            try {
                setRefreshUI('busy', 'updating');
                await loadAllData();
                setRefreshUI('idle', 'ready');
            } catch (e) {
                console.error(e);
                setRefreshUI('idle', 'error');
            }
        }

        document.addEventListener('DOMContentLoaded', init);
    </script>

    <!-- Admin Login Modal -->
    <div class="modal-overlay" id="adminModal" onclick="if(event.target===this)closeAdminModal()">
        <div class="admin-modal" id="adminModalBox">
            <div class="admin-modal-header">
                <h3><i class="fa-solid fa-shield-halved"></i> <span data-en>Admin Panel</span><span data-tr>Yönetici Paneli</span></h3>
                <div style="display:flex; gap:0.5rem; align-items:center;">
                    <span style="font-size:0.7rem; color:#64748b;"><i class="fa-solid fa-arrows-alt"></i> <span data-en>Drag to resize</span><span data-tr>Boyutlandır</span></span>
                    <button class="btn btn-ghost btn-sm" onclick="closeAdminModal()"><i class="fa-solid fa-times"></i></button>
                </div>
            </div>
            
            <div class="admin-modal-body">
                <!-- Login Form -->
                <div id="adminLoginForm" class="admin-section">
                    <p class="admin-desc"><span data-en>Enter password to access the data editor</span><span data-tr>Veri düzenleyiciye erişmek için şifre girin</span></p>
                    <div class="admin-input-group">
                        <input type="password" id="adminPassword" placeholder="Password / Şifre" class="admin-input" onkeypress="if(event.key==='Enter')checkAdminLogin()">
                        <button class="btn btn-accent" onclick="checkAdminLogin()">
                            <i class="fa-solid fa-arrow-right"></i>
                        </button>
                    </div>
                    <p class="admin-hint" id="loginError" style="color:#ec4899; display:none;">
                        <i class="fa-solid fa-exclamation-circle"></i> <span data-en>Incorrect password</span><span data-tr>Yanlış şifre</span>
                    </p>
                </div>
                
                <!-- Sheet Editor (hidden until login) -->
                <div id="adminSheetEditor" style="display:none; height:100%; flex-direction:column;">
                    <div class="admin-tabs">
                        <button class="admin-tab active" onclick="showAdminTab('embed')"><i class="fa-solid fa-table"></i> <span data-en>Edit Data</span><span data-tr>Veri Düzenle</span></button>
                        <button class="admin-tab" onclick="showAdminTab('settings')"><i class="fa-solid fa-cog"></i> <span data-en>Settings</span><span data-tr>Ayarlar</span></button>
                    </div>
                    
                    <div id="adminTabEmbed" class="admin-tab-content" style="flex:1; display:flex; flex-direction:column;">
                        <p class="admin-desc"><span data-en>Edit your Google Sheet directly:</span><span data-tr>Google Sheet'inizi doğrudan düzenleyin:</span></p>
                        <div class="sheet-embed-container" style="flex:1; min-height:300px; position:relative;">
                            <div id="sheetLoadingIndicator" style="position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); text-align:center; color:var(--text-muted);">
                                <i class="fa-solid fa-spinner fa-spin" style="font-size:2rem; margin-bottom:0.5rem;"></i>
                                <p><span data-en>Loading Google Sheet...</span><span data-tr>Google Sheet yükleniyor...</span></p>
                            </div>
                            <iframe id="sheetEmbed" src="" frameborder="0" style="width:100%; height:100%; min-height:300px; border-radius:8px; border:1px solid #e2e0dc;" onload="document.getElementById('sheetLoadingIndicator').style.display='none';"></iframe>
                        </div>
                        <div class="admin-actions" style="margin-top:1rem;">
                            <a href="" id="openSheetLink" target="_blank" class="btn btn-ghost">
                                <i class="fa-solid fa-external-link"></i> <span data-en>Open in Google Sheets</span><span data-tr>Google Sheets'te Aç</span>
                            </a>
                            <button class="btn btn-accent" onclick="refreshData(); closeAdminModal();">
                                <i class="fa-solid fa-rotate"></i> <span data-en>Refresh Site Data</span><span data-tr>Site Verisini Yenile</span>
                            </button>
                        </div>
                    </div>
                    
                    <div id="adminTabSettings" class="admin-tab-content" style="display:none;">
                        <div class="settings-group">
                            <label><span data-en>Google Sheet ID</span><span data-tr>Google Sheet ID</span></label>
                            <input type="text" id="settingSheetId" class="admin-input" style="width:100%;">
                            <p class="admin-hint"><span data-en>Found in the sheet URL after /d/</span><span data-tr>Sheet URL'sinde /d/ sonrasında bulunur</span></p>
                        </div>
                        
                        <!-- Warning when sheet password is set -->
                        <div id="sheetPasswordWarning" class="settings-group" style="display:none; background:#fef3c7; padding:1rem; border-radius:8px; border-left:4px solid var(--amber);">
                            <p style="margin:0; color:#92400e;"><i class="fa-solid fa-shield-halved" style="color:#d97706;"></i> 
                            <strong><span data-en>Password Protected via Google Sheet</span><span data-tr>Google Sheet ile Şifre Korumalı</span></strong></p>
                            <p style="margin:0.5rem 0 0 0; font-size:0.85rem; color:#78350f;">
                            <span data-en>Admin password is set in your Google Sheet's Settings tab. Only the sheet owner can change it. This is the most secure option.</span>
                            <span data-tr>Yönetici şifresi Google Sheet'inizin Settings sekmesinde ayarlanmış. Sadece sheet sahibi değiştirebilir. Bu en güvenli seçenektir.</span></p>
                        </div>
                        
                        <div class="settings-group" id="localPasswordSection">
                            <label><span data-en>Change Admin Password</span><span data-tr>Yönetici Şifresini Değiştir</span></label>
                            <input type="password" id="settingCurrentPassword" class="admin-input" style="width:100%; margin-bottom:0.5rem;" placeholder="Current password / Mevcut şifre">
                            <input type="password" id="settingNewPassword" class="admin-input" style="width:100%;" placeholder="New password / Yeni şifre">
                            <p class="admin-hint"><i class="fa-solid fa-shield-halved" style="color:var(--accent);"></i> <span data-en><strong>Recommended:</strong> Set password in your Google Sheet's Settings tab with key "admin_password" for better security. Sheet passwords cannot be changed from this panel.</span><span data-tr><strong>Önerilen:</strong> Daha iyi güvenlik için Google Sheet'inizin Settings sekmesine "admin_password" anahtarıyla şifre ekleyin. Sheet şifreleri bu panelden değiştirilemez.</span></p>
                        </div>
                        <button class="btn btn-accent" onclick="saveAdminSettings()">
                            <i class="fa-solid fa-save"></i> <span data-en>Save Settings</span><span data-tr>Ayarları Kaydet</span>
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="resize-handle" title="Resize"></div>
        </div>
    </div>

    <style>
        /* Admin Modal Styles */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.6);
            backdrop-filter: blur(4px);
            z-index: 1000;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }
        .modal-overlay.show { display: flex; }
        .admin-modal {
            background: #ffffff;
            border-radius: 12px;
            width: 800px;
            min-width: 400px;
            max-width: 95vw;
            height: 600px;
            min-height: 300px;
            max-height: 90vh;
            overflow: hidden;
            box-shadow: 0 25px 80px rgba(0,0,0,0.3);
            display: flex;
            flex-direction: column;
            resize: both;
            position: relative;
        }
        .admin-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 1.25rem;
            border-bottom: 1px solid #e2e0dc;
            background: #faf8f5;
            flex-shrink: 0;
            cursor: move;
        }
        .admin-modal-header h3 {
            margin: 0;
            font-size: 1.1rem;
            color: #0c1220;
        }
        .admin-modal-body {
            flex: 1;
            overflow-y: auto;
            background: #ffffff;
        }
        .admin-section { padding: 1.25rem; }
        .admin-desc {
            color: #475569;
            margin: 0 0 1rem 0;
            font-size: 0.9rem;
        }
        .admin-input-group {
            display: flex;
            gap: 0.5rem;
        }
        .admin-input {
            flex: 1;
            padding: 0.6rem 0.9rem;
            border: 1px solid #e2e0dc;
            border-radius: 8px;
            font-size: 0.95rem;
            background: #faf8f5;
        }
        .admin-input:focus {
            outline: none;
            border-color: #6366f1;
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.15);
        }
        .admin-hint {
            font-size: 0.8rem;
            color: #64748b;
            margin: 0.75rem 0 0 0;
        }
        .admin-tabs {
            display: flex;
            gap: 0.25rem;
            padding: 0 1.25rem;
            border-bottom: 1px solid #e2e0dc;
            background: #faf8f5;
        }
        .admin-tab {
            padding: 0.6rem 1rem;
            background: none;
            border: none;
            font-size: 0.85rem;
            color: #64748b;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            margin-bottom: -1px;
        }
        .admin-tab:hover { color: #0c1220; }
        .admin-tab.active {
            color: #6366f1;
            border-bottom-color: #6366f1;
        }
        .admin-tab-content { 
            padding: 1.25rem; 
            background: #ffffff;
        }
        .sheet-embed-container {
            background: #faf8f5;
            border-radius: 8px;
            padding: 0.5rem;
            margin-bottom: 1rem;
            border: 1px solid #e2e0dc;
        }
        .sheet-embed-container iframe {
            min-height: 350px;
            height: calc(100% - 10px);
        }
        .admin-actions {
            display: flex;
            gap: 0.75rem;
            justify-content: flex-end;
            flex-wrap: wrap;
        }
        .settings-group {
            margin-bottom: 1rem;
        }
        .settings-group label {
            display: block;
            font-weight: 500;
            margin-bottom: 0.4rem;
            font-size: 0.9rem;
            color: #0c1220;
        }
        .resize-handle {
            position: absolute;
            bottom: 0;
            right: 0;
            width: 20px;
            height: 20px;
            cursor: nwse-resize;
            background: linear-gradient(135deg, transparent 50%, #cbd5e1 50%);
            border-radius: 0 0 12px 0;
        }
    </style>

    <script>
        // ═══════════════════════════════════════════════════════════════════════════
        // ADMIN & UPDATE PANEL FUNCTIONS
        // ═══════════════════════════════════════════════════════════════════════════
        // SIDEBAR DATA PANEL & ADMIN FUNCTIONS
        // ═══════════════════════════════════════════════════════════════════════════
        
        // SHA-256 hash function for secure password storage
        async function secureHash(str) {
            const msgBuffer = new TextEncoder().encode(str);
            const hashBuffer = await crypto.subtle.digest('SHA-256', msgBuffer);
            const hashArray = Array.from(new Uint8Array(hashBuffer));
            return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
        }
        
        // Synchronous simple hash for backward compatibility (will be migrated)
        function simpleHash(str) {
            let hash = 0;
            for (let i = 0; i < str.length; i++) {
                const char = str.charCodeAt(i);
                hash = ((hash << 5) - hash) + char;
                hash = hash & hash;
            }
            return hash.toString(36);
        }
        
        // Config stored in localStorage
        // Password can be set in Google Sheet Settings tab with key: admin_password
        // If not set in sheet, falls back to localStorage, then to default
        const ADMIN_CONFIG = {
            passwordHash: localStorage.getItem('adminPasswordHash') || null,
            sheetPasswordHash: null, // Will be set after loading settings
            sheetId: localStorage.getItem('sheetId') || GOOGLE_SHEET_ID
        };
        
        // Check password against both sheet password and local password
        async function verifyPassword(pwd) {
            const pwdHash = await secureHash(pwd);
            
            // First check: Sheet password (if configured)
            if (ADMIN_CONFIG.sheetPasswordHash) {
                if (pwdHash === ADMIN_CONFIG.sheetPasswordHash) return true;
            }
            
            // Second check: Local password
            if (ADMIN_CONFIG.passwordHash) {
                // Check new secure hash
                if (pwdHash === ADMIN_CONFIG.passwordHash) return true;
                // Backward compatibility: check old simple hash
                if (simpleHash(pwd) === ADMIN_CONFIG.passwordHash) {
                    // Migrate to secure hash
                    localStorage.setItem('adminPasswordHash', pwdHash);
                    ADMIN_CONFIG.passwordHash = pwdHash;
                    return true;
                }
            }
            
            // Default password check (only if no password is configured anywhere)
            if (!ADMIN_CONFIG.sheetPasswordHash && !ADMIN_CONFIG.passwordHash) {
                const defaultHash = await secureHash('admin123');
                if (pwdHash === defaultHash) {
                    console.warn('âš ï¸ Using default password. Please change it in Settings or Google Sheet!');
                    return true;
                }
            }
            
            return false;
        }
        
        // Toggle sidebar data panel
        function toggleDataPanel() {
            const panel = document.querySelector('.sidebar-data-panel');
            panel.classList.toggle('open');
        }
        
        // Toggle change log in sidebar
        function toggleChangeLog() {
            const log = document.getElementById('sidebarChangeLog');
            log.style.display = log.style.display === 'none' ? 'block' : 'none';
        }
        
        // Clear change history to reset baseline
        function clearChangeHistory() {
            const confirmMsg = lang === 'tr' 
                ? 'Değişiklik geçmişi sıfırlanacak. Devam edilsin mi?' 
                : 'This will reset the change history baseline. Continue?';
            
            if (confirm(confirmMsg)) {
                localStorage.removeItem('previousDataSnapshot');
                PREVIOUS_DATA = {};
                
                const successMsg = lang === 'tr'
                    ? 'Geçmiş sıfırlandı.'
                    : 'History cleared.';
                alert(successMsg);
                refreshData();
            }
        }
        
        function openAdminLogin() {
            document.getElementById('adminModal').classList.add('show');
            document.getElementById('adminPassword').focus();
            document.getElementById('settingSheetId').value = ADMIN_CONFIG.sheetId;
        }
        
        function closeAdminModal() {
            document.getElementById('adminModal').classList.remove('show');
            document.getElementById('loginError').style.display = 'none';
            document.getElementById('adminPassword').value = '';
        }
        
        async function checkAdminLogin() {
            const pwd = document.getElementById('adminPassword').value;
            const isValid = await verifyPassword(pwd);
            
            if (isValid) {
                document.getElementById('adminLoginForm').style.display = 'none';
                document.getElementById('adminSheetEditor').style.display = 'flex';
                
                // Load embedded sheet
                const sheetUrl = `https://docs.google.com/spreadsheets/d/${ADMIN_CONFIG.sheetId}/edit?usp=sharing&rm=embedded`;
                document.getElementById('sheetEmbed').src = sheetUrl;
                document.getElementById('openSheetLink').href = `https://docs.google.com/spreadsheets/d/${ADMIN_CONFIG.sheetId}/edit`;
                
                // Update password section visibility based on whether sheet password is set
                updatePasswordSectionVisibility();
            } else {
                document.getElementById('loginError').style.display = 'block';
                document.getElementById('adminPassword').value = '';
            }
        }
        
        function updatePasswordSectionVisibility() {
            const hasSheetPassword = !!ADMIN_CONFIG.sheetPasswordHash;
            const warningEl = document.getElementById('sheetPasswordWarning');
            const localPwdSection = document.getElementById('localPasswordSection');
            
            if (hasSheetPassword) {
                // Sheet password is set - show warning, hide local password change
                warningEl.style.display = 'block';
                localPwdSection.style.display = 'none';
            } else {
                // No sheet password - show local password change option
                warningEl.style.display = 'none';
                localPwdSection.style.display = 'block';
            }
        }
        
        function showAdminTab(tab) {
            document.querySelectorAll('.admin-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.admin-tab-content').forEach(c => c.style.display = 'none');
            
            event.target.closest('.admin-tab').classList.add('active');
            const tabContent = document.getElementById('adminTab' + tab.charAt(0).toUpperCase() + tab.slice(1));
            tabContent.style.display = tab === 'embed' ? 'flex' : 'block';
        }
        
        async function saveAdminSettings() {
            const newSheetId = document.getElementById('settingSheetId').value.trim();
            const currentPwd = document.getElementById('settingCurrentPassword').value.trim();
            const newPwd = document.getElementById('settingNewPassword').value.trim();
            
            // Update sheet ID
            if (newSheetId && newSheetId !== ADMIN_CONFIG.sheetId) {
                localStorage.setItem('sheetId', newSheetId);
                ADMIN_CONFIG.sheetId = newSheetId;
                GOOGLE_SHEET_ID = newSheetId;
            }
            
            // Update password (requires current password verification)
            // Block if sheet password is set (can only be changed in Google Sheet)
            if (newPwd) {
                if (ADMIN_CONFIG.sheetPasswordHash) {
                    alert(lang === 'tr' 
                        ? 'Şifre Google Sheet\'te ayarlanmış. Sadece sheet üzerinden değiştirilebilir.' 
                        : 'Password is set in Google Sheet. It can only be changed there.');
                    return;
                }
                if (!currentPwd) {
                    alert(lang === 'tr' ? 'Mevcut şifreyi girin' : 'Enter current password');
                    return;
                }
                const isCurrentValid = await verifyPassword(currentPwd);
                if (!isCurrentValid) {
                    alert(lang === 'tr' ? 'Mevcut şifre yanlış' : 'Current password is incorrect');
                    return;
                }
                const newHash = await secureHash(newPwd);
                localStorage.setItem('adminPasswordHash', newHash);
                ADMIN_CONFIG.passwordHash = newHash;
            }
            
            alert(lang === 'tr' ? 'Ayarlar kaydedildi! Sayfa yenilenecek.' : 'Settings saved! Page will reload.');
            location.reload();
        }
    </script>

    <!-- 
    ╔═══════════════════════════════════════════════════════════════════════════════╗
    ║                         SETUP INSTRUCTIONS                                     ║
    ╠═══════════════════════════════════════════════════════════════════════════════╣
    ║                                                                                ║
    ║  1. CREATE A GOOGLE SHEET with these tabs (exact names):                       ║
    ║     - Settings, News, Events, Faculty, Research, Publications,                 ║
    ║     - Courses, Projects, Labs, Jobs, Alumni, Partners, Students               ║
    ║                                                                                ║
    ║  2. PUBLISH THE SHEET:                                                         ║
    ║     File → Share → Publish to web → Entire Document → CSV → Publish           ║
    ║                                                                                ║
    ║  3. COPY THE SHEET ID from the URL:                                            ║
    ║     https://docs.google.com/spreadsheets/d/[THIS_IS_THE_ID]/edit              ║
    ║                                                                                ║
    ║  4. PASTE THE ID in the GOOGLE_SHEET_ID variable at the top of this file       ║
    ║                                                                                ║
    ║  See the template sheet structure in the README or create your own.            ║
    ║                                                                                ║
    ╚═══════════════════════════════════════════════════════════════════════════════╝
    -->
</body>

</html>