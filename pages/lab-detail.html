<!-- Lab Detail Page -->
<div class="detail-page">
    <button onclick="Router.goTo('labs')" class="btn btn-ghost btn-sm detail-back">
        <i class="fa-solid fa-arrow-left"></i> <span id="labBackBtn">Back to Labs</span>
    </button>
    
    <div class="detail-card">
        <div class="detail-image" id="labDetailImage"></div>
        <div class="detail-body">
            <div class="detail-meta">
                <span class="tag" id="labDetailType">Lab</span>
            </div>
            <h1 class="detail-title" id="labDetailTitle">Loading...</h1>
            
            <div class="detail-info-grid">
                <div class="detail-info-item">
                    <i class="fa-solid fa-door-open"></i>
                    <div>
                        <span class="detail-info-label" id="labLabelRoom">Room</span>
                        <span class="detail-info-value" id="labDetailRoom"></span>
                    </div>
                </div>
                <div class="detail-info-item">
                    <i class="fa-solid fa-user-tie"></i>
                    <div>
                        <span class="detail-info-label" id="labLabelManager">Manager</span>
                        <span class="detail-info-value" id="labDetailManager"></span>
                    </div>
                </div>
            </div>
            
            <div class="detail-content" id="labDetailContent"></div>
            
            <div class="detail-equipment-box">
                <h4><i class="fa-solid fa-wrench"></i> <span id="labLabelEquipment">Equipment</span></h4>
                <p id="labDetailEquipment"></p>
            </div>
        </div>
    </div>
</div>

<script>
(function() {
    // Main render function - called by router after page loads
    function renderLabDetailPage() {
        const index = window.currentDetailIndex;
        if (typeof index !== 'number' || index < 0) return;
        
        const data = getData('labs');
        if (!data || data.length === 0) {
            setTimeout(renderLabDetailPage, 100);
            return;
        }
        
        const l = data[index];
        if (!l) {
            console.error('Lab not found at index:', index);
            return;
        }
        
        // Update labels with current language
        document.getElementById('labBackBtn').textContent = t('Back to Labs', 'Lablara Dön');
        document.getElementById('labLabelRoom').textContent = t('Room', 'Oda');
        document.getElementById('labLabelManager').textContent = t('Manager', 'Yönetici');
        document.getElementById('labLabelEquipment').textContent = t('Equipment', 'Ekipman');
        
        const typeClass = (l.type || '').toLowerCase() === 'research' ? 'tag-green' : 'tag-accent';
        
        document.getElementById('labDetailType').textContent = l.type || 'Lab';
        document.getElementById('labDetailType').className = 'tag ' + typeClass;
        document.getElementById('labDetailTitle').textContent = t(l.name_en, l.name_tr) || l.name || 'Laboratory';
        document.getElementById('labDetailRoom').textContent = l.room || '—';
        document.getElementById('labDetailManager').textContent = l.manager || '—';
        document.getElementById('labDetailImage').style.backgroundImage = `url('${l.image || 'https://images.unsplash.com/photo-1581092160562-40aa08e78837?w=600&q=80'}')`;
        
        const content = t(l.content_en, l.content_tr) || t(l.description_en, l.description_tr) || '';
        document.getElementById('labDetailContent').innerHTML = content.replace(/\n/g, '<br>');
        
        const equipment = t(l.equipment_en, l.equipment_tr) || '';
        document.getElementById('labDetailEquipment').textContent = equipment;
    }
    
    // Register render function with multiple naming conventions for router compatibility
    window.renderLabDetailPage = renderLabDetailPage;
    window['renderLab-detailPage'] = renderLabDetailPage;
    window.renderLabdetailPage = renderLabDetailPage;
    
    if (typeof window.currentDetailIndex === 'number') {
        setTimeout(renderLabDetailPage, 50);
    }
})();
</script>
