<!-- Job Detail Page -->
<div class="detail-page">
    <button onclick="Router.goTo('jobs')" class="btn btn-ghost btn-sm detail-back">
        <i class="fa-solid fa-arrow-left"></i> <span id="jobBackBtn">Back to Jobs</span>
    </button>
    
    <div class="detail-card">
        <div class="detail-body">
            <div class="detail-meta">
                <span class="tag" id="jobDetailType">Full-time</span>
            </div>
            <h1 class="detail-title" id="jobDetailTitle">Loading...</h1>
            
            <div class="detail-info-grid">
                <div class="detail-info-item">
                    <i class="fa-solid fa-building"></i>
                    <div>
                        <span class="detail-info-label" id="jobLabelCompany">Company</span>
                        <span class="detail-info-value" id="jobDetailCompany"></span>
                    </div>
                </div>
                <div class="detail-info-item">
                    <i class="fa-solid fa-location-dot"></i>
                    <div>
                        <span class="detail-info-label" id="jobLabelLocation">Location</span>
                        <span class="detail-info-value" id="jobDetailLocation"></span>
                    </div>
                </div>
                <div class="detail-info-item" id="jobSalaryItem" style="display:none;">
                    <i class="fa-solid fa-money-bill"></i>
                    <div>
                        <span class="detail-info-label" id="jobLabelSalary">Salary</span>
                        <span class="detail-info-value" id="jobDetailSalary"></span>
                    </div>
                </div>
                <div class="detail-info-item" id="jobDeadlineItem" style="display:none;">
                    <i class="fa-solid fa-calendar-xmark"></i>
                    <div>
                        <span class="detail-info-label" id="jobLabelDeadline">Deadline</span>
                        <span class="detail-info-value" id="jobDetailDeadline"></span>
                    </div>
                </div>
            </div>
            
            <div class="detail-content" id="jobDetailContent"></div>
            
            <div id="jobRequirementsBox" class="detail-tech-box" style="display:none;">
                <h4><i class="fa-solid fa-list-check"></i> <span id="jobLabelReq">Requirements</span></h4>
                <div id="jobDetailRequirements"></div>
            </div>
            
            <div id="jobApplyBox" class="detail-actions" style="display:none;">
                <a href="#" id="jobApplyLink" class="btn btn-accent" target="_blank">
                    <i class="fa-solid fa-paper-plane"></i> <span id="jobLabelApply">Apply Now</span>
                </a>
            </div>
        </div>
    </div>
</div>

<script>
(function() {
    // Main render function - called by router after page loads
    function renderJobDetailPage() {
        const index = window.currentDetailIndex;
        console.log('renderJobDetailPage called, index:', index);
        
        if (typeof index !== 'number' || index < 0) {
            console.warn('No valid job index set');
            return;
        }
        
        const data = getData('jobs');
        console.log('Jobs data:', data);
        
        if (!data || data.length === 0) {
            console.warn('Jobs data not loaded yet, retrying...');
            setTimeout(renderJobDetailPage, 100);
            return;
        }
        
        const j = data[index];
        if (!j) {
            console.error('Job not found at index:', index);
            return;
        }
        
        const typeClass = (j.type || '').toLowerCase().includes('intern') ? 'tag-green' : 
                          (j.type || '').toLowerCase().includes('part') ? 'tag-amber' : 'tag-accent';
        
        // Update labels with current language
        document.getElementById('jobBackBtn').textContent = t('Back to Jobs', 'İş İlanlarına Dön');
        document.getElementById('jobLabelCompany').textContent = t('Company', 'Şirket');
        document.getElementById('jobLabelLocation').textContent = t('Location', 'Konum');
        document.getElementById('jobLabelSalary').textContent = t('Salary', 'Maaş');
        document.getElementById('jobLabelDeadline').textContent = t('Deadline', 'Son Tarih');
        document.getElementById('jobLabelReq').textContent = t('Requirements', 'Gereksinimler');
        document.getElementById('jobLabelApply').textContent = t('Apply Now', 'Şimdi Başvur');
        
        document.getElementById('jobDetailType').textContent = j.type || 'Full-Time';
        document.getElementById('jobDetailType').className = 'tag ' + typeClass;
        document.getElementById('jobDetailTitle').textContent = t(j.title_en, j.title_tr) || j.title || 'Job Opening';
        document.getElementById('jobDetailCompany').textContent = j.company || '—';
        document.getElementById('jobDetailLocation').textContent = j.location || '—';
        
        const content = t(j.content_en, j.content_tr) || t(j.description_en, j.description_tr) || '';
        document.getElementById('jobDetailContent').innerHTML = content.replace(/\n/g, '<br>');
        
        // Salary
        const salaryItem = document.getElementById('jobSalaryItem');
        if (j.salary) {
            salaryItem.style.display = 'flex';
            document.getElementById('jobDetailSalary').textContent = j.salary;
        } else {
            salaryItem.style.display = 'none';
        }
        
        // Deadline
        const deadlineItem = document.getElementById('jobDeadlineItem');
        if (j.deadline) {
            deadlineItem.style.display = 'flex';
            document.getElementById('jobDetailDeadline').textContent = j.deadline;
        } else {
            deadlineItem.style.display = 'none';
        }
        
        // Requirements
        const reqBox = document.getElementById('jobRequirementsBox');
        if (j.requirements) {
            reqBox.style.display = 'block';
            document.getElementById('jobDetailRequirements').innerHTML = j.requirements.split(',').map(r => 
                `<span class="tag" style="margin:2px;">${r.trim()}</span>`
            ).join('');
        } else {
            reqBox.style.display = 'none';
        }
        
        // Apply link
        const applyBox = document.getElementById('jobApplyBox');
        if (j.apply_link) {
            applyBox.style.display = 'block';
            document.getElementById('jobApplyLink').href = j.apply_link;
        } else {
            applyBox.style.display = 'none';
        }
    }
    
    // Register render function with multiple naming conventions for router compatibility
    window.renderJobDetailPage = renderJobDetailPage;
    window['renderJob-detailPage'] = renderJobDetailPage;
    window.renderJobdetailPage = renderJobDetailPage;
    
    // Also try to render immediately if data might already be loaded
    if (typeof window.currentDetailIndex === 'number') {
        setTimeout(renderJobDetailPage, 50);
    }
})();
</script>
